<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CNU Deep Learning - 5&nbsp; Bioinformatics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./cnu_machine_learning.html" rel="next">
<link href="./cnu_data_handling.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./cnu_bioinformatics.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bioinformatics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CNU Deep Learning</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cnu_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cnu_basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cnu_data_handling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data handling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cnu_bioinformatics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bioinformatics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cnu_machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cnu_deeplearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Deep Learning</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#user" id="toc-user" class="nav-link active" data-scroll-target="#user"><span class="header-section-number">5.1</span> [User]</a></li>
  <li><a href="#chatgpt" id="toc-chatgpt" class="nav-link" data-scroll-target="#chatgpt"><span class="header-section-number">5.2</span> [ChatGPT]</a></li>
  <li><a href="#biopython" id="toc-biopython" class="nav-link" data-scroll-target="#biopython"><span class="header-section-number">5.3</span> Biopython</a>
  <ul class="collapse">
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation"><span class="header-section-number">5.3.1</span> Installation</a></li>
  <li><a href="#sequence-objects" id="toc-sequence-objects" class="nav-link" data-scroll-target="#sequence-objects"><span class="header-section-number">5.3.2</span> Sequence objects</a></li>
  <li><a href="#seqrecord" id="toc-seqrecord" class="nav-link" data-scroll-target="#seqrecord"><span class="header-section-number">5.3.3</span> SeqRecord</a></li>
  <li><a href="#entrez" id="toc-entrez" class="nav-link" data-scroll-target="#entrez"><span class="header-section-number">5.3.4</span> Entrez</a></li>
  <li><a href="#pairwise-sequence-alignment" id="toc-pairwise-sequence-alignment" class="nav-link" data-scroll-target="#pairwise-sequence-alignment"><span class="header-section-number">5.3.5</span> Pairwise sequence alignment</a></li>
  <li><a href="#multiple-sequence-alignment-objects" id="toc-multiple-sequence-alignment-objects" class="nav-link" data-scroll-target="#multiple-sequence-alignment-objects"><span class="header-section-number">5.3.6</span> Multiple sequence alignment objects</a></li>
  <li><a href="#scikit-bio" id="toc-scikit-bio" class="nav-link" data-scroll-target="#scikit-bio"><span class="header-section-number">5.3.7</span> scikit-bio</a></li>
  <li><a href="#example-analyzing-a-protein-sequence" id="toc-example-analyzing-a-protein-sequence" class="nav-link" data-scroll-target="#example-analyzing-a-protein-sequence"><span class="header-section-number">5.3.8</span> Example: Analyzing a Protein Sequence</a></li>
  <li><a href="#explanation" id="toc-explanation" class="nav-link" data-scroll-target="#explanation"><span class="header-section-number">5.3.9</span> Explanation:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bioinformatics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="user" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="user"><span class="header-section-number">5.1</span> [User]</h2>
<p><span style="color:blue; font-size:20pt"> I want to learn about “3. Bioinformatics Libraries”. Can you explain it with example codes? </span></p>
</section>
<section id="chatgpt" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="chatgpt"><span class="header-section-number">5.2</span> [ChatGPT]</h2>
<p>Certainly! Bioinformatics libraries in Python, such as Biopython and scikit-bio, provide tools and functions to handle biological data, including sequence analysis, structure analysis, and more. Here’s a brief introduction to these libraries with example codes.</p>
</section>
<section id="biopython" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="biopython"><span class="header-section-number">5.3</span> Biopython</h2>
<p>Biopython is one of the most widely used libraries for bioinformatics in Python. It provides tools for reading and writing different bioinformatics file formats, performing sequence analysis, and interacting with biological databases.</p>
<div id="cell-3" class="cell" data-executioninfo="{&quot;elapsed&quot;:20821,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002750875,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="8a157136-41b0-42b3-8897-f2ace2be6cf0" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">'/content/drive'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">'drive/MyDrive/2024-cnu-lecture'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mounted at /content/drive</code></pre>
</div>
</div>
<section id="installation" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="installation"><span class="header-section-number">5.3.1</span> Installation</h3>
<div id="cell-5" class="cell" data-executioninfo="{&quot;elapsed&quot;:9908,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002763618,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="3c545f70-ff28-424f-93d7-f84d13d23b22" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install biopython</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting biopython
  Downloading biopython-1.83-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.1/3.1 MB 13.3 MB/s eta 0:00:00
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from biopython) (1.25.2)
Installing collected packages: biopython
Successfully installed biopython-1.83</code></pre>
</div>
</div>
</section>
<section id="sequence-objects" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="sequence-objects"><span class="header-section-number">5.3.2</span> Sequence objects</h3>
<div id="cell-7" class="cell" data-outputid="1295a5dc-59c4-4ed7-8849-50076533dac2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>my_seq <span class="op">=</span> Seq(<span class="st">"AGTACACTGGT"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>my_seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>Seq('AGTACACTGGT')</code></pre>
</div>
</div>
<div id="cell-8" class="cell" data-outputid="3ff9b3ec-4a40-48b2-8dc3-c497adf5b78b">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, letter <span class="kw">in</span> <span class="bu">enumerate</span>(my_seq):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="sc">%i</span><span class="st"> </span><span class="sc">%s</span><span class="st"> "</span> <span class="op">%</span> (index, letter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 A 
1 G 
2 T 
3 A 
4 C 
5 A 
6 C 
7 T 
8 G 
9 G 
10 T </code></pre>
</div>
</div>
<div id="cell-9" class="cell" data-outputid="934382f3-a7aa-412f-dbd1-b5b8089e1012">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">enumerate</span>(x):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> x:</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0, 1)
(1, 4)
(2, 5)
(3, 7)
(4, 8)
1
4
5
7
8</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-outputid="d791241b-ece1-4078-d9c6-59f67c1adf88">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq[<span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq[<span class="dv">0</span>::<span class="dv">2</span>])</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">str</span>(my_seq))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq <span class="op">+</span> <span class="st">"ATG"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq<span class="op">==</span><span class="st">"ATG"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AGT"</span> <span class="kw">in</span> my_seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AGTACACTGGT
AGT
ATCCGT
AGTACACTGGT
AGTACACTGGTATG
False
True</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-outputid="d1ce940f-8fc0-464a-fe75-ed659f4c6773">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>my_seq_low <span class="op">=</span> my_seq.lower()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq_low)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq_low.upper())</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq.complement())</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq.reverse_complement())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>agtacactggt
AGTACACTGGT
TCATGTGACCA
ACCAGTGTACT</code></pre>
</div>
</div>
<ul>
<li>Transcription, Translation</li>
</ul>
<div id="cell-13" class="cell" data-outputid="155b3645-42a7-4fa3-a8e1-14e726ef5055">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mrna <span class="op">=</span> my_seq.transcribe()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mrna)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>prot <span class="op">=</span> mrna.translate() <span class="co">## truncated</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prot)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_seq.translate())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AGUACACUGGU
STL
STL</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/haseong/anaconda3/envs/biopy/lib/python3.11/site-packages/Bio/Seq.py:2880: BiopythonWarning: Partial codon, len(sequence) not a multiple of three. Explicitly trim the sequence or add trailing N before translation. This may become an error in future.
  warnings.warn(</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-outputid="36137abe-7606-4fff-deb0-45d2b27e0d6d">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Data <span class="im">import</span> CodonTable</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>standard_table <span class="op">=</span> CodonTable.unambiguous_dna_by_id[<span class="dv">1</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(standard_table)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(standard_table.start_codons)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(standard_table.stop_codons)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(standard_table))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Table 1 Standard, SGC0

  |  T      |  C      |  A      |  G      |
--+---------+---------+---------+---------+--
T | TTT F   | TCT S   | TAT Y   | TGT C   | T
T | TTC F   | TCC S   | TAC Y   | TGC C   | C
T | TTA L   | TCA S   | TAA Stop| TGA Stop| A
T | TTG L(s)| TCG S   | TAG Stop| TGG W   | G
--+---------+---------+---------+---------+--
C | CTT L   | CCT P   | CAT H   | CGT R   | T
C | CTC L   | CCC P   | CAC H   | CGC R   | C
C | CTA L   | CCA P   | CAA Q   | CGA R   | A
C | CTG L(s)| CCG P   | CAG Q   | CGG R   | G
--+---------+---------+---------+---------+--
A | ATT I   | ACT T   | AAT N   | AGT S   | T
A | ATC I   | ACC T   | AAC N   | AGC S   | C
A | ATA I   | ACA T   | AAA K   | AGA R   | A
A | ATG M(s)| ACG T   | AAG K   | AGG R   | G
--+---------+---------+---------+---------+--
G | GTT V   | GCT A   | GAT D   | GGT G   | T
G | GTC V   | GCC A   | GAC D   | GGC G   | C
G | GTA V   | GCA A   | GAA E   | GGA G   | A
G | GTG V   | GCG A   | GAG E   | GGG G   | G
--+---------+---------+---------+---------+--
['TTG', 'CTG', 'ATG']
['TAA', 'TAG', 'TGA']
&lt;class 'Bio.Data.CodonTable.NCBICodonTableDNA'&gt;</code></pre>
</div>
</div>
<ul>
<li>MutableSeq objects</li>
</ul>
<div id="cell-16" class="cell" data-outputid="e2149944-38bf-4c07-8400-087bbe4463af">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>my_seq <span class="op">=</span> Seq(<span class="st">"AGTACACTGGT"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>my_seq[<span class="dv">5</span>] <span class="op">=</span> <span class="st">"G"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: 'Seq' object does not support item assignment</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-outputid="8f29420d-bc3d-4bfa-8a79-2f1a8ae5ce75">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Seq <span class="im">import</span> MutableSeq</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>mutable_seq <span class="op">=</span> MutableSeq(my_seq)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>mutable_seq</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>mutable_seq[<span class="dv">5</span>] <span class="op">=</span> <span class="st">"G"</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>mutable_seq</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>new_seq <span class="op">=</span> Seq(mutable_seq)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>new_seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Seq('AGTACGCTGGT')</code></pre>
</div>
</div>
<ul>
<li>Finding subsequence</li>
</ul>
<div id="cell-19" class="cell" data-outputid="a2e8cb31-bac1-4f7b-8fed-0b383f32ea00">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>seq <span class="op">=</span> Seq(<span class="st">"GCCATTGTAATGGGCCGCTGAAAGGGTGCCCGA"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq.index(<span class="st">"ATG"</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq.find(<span class="st">"ATG"</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq.find(<span class="st">"AAAAA"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9
9
-1</code></pre>
</div>
</div>
</section>
<section id="seqrecord" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="seqrecord"><span class="header-section-number">5.3.3</span> SeqRecord</h3>
<ul>
<li>Sequence annotation objects</li>
<li>특정 서열의 identifier나 feature 정보 포함</li>
</ul>
<div id="cell-22" class="cell" data-executioninfo="{&quot;elapsed&quot;:605,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002778363,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.SeqRecord <span class="im">import</span> SeqRecord</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>simple_seq <span class="op">=</span> Seq(<span class="st">"GATC"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>simple_seq_r <span class="op">=</span> SeqRecord(simple_seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell" data-executioninfo="{&quot;elapsed&quot;:527,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002786384,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="7220a557-9038-4344-bb40-58f79c14aba4" data-execution_count="4">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(SeqRecord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Help on class SeqRecord in module Bio.SeqRecord:

class SeqRecord(builtins.object)
 |  SeqRecord(seq: Union[ForwardRef('Seq'), ForwardRef('MutableSeq'), NoneType], id: Optional[str] = '&lt;unknown id&gt;', name: str = '&lt;unknown name&gt;', description: str = '&lt;unknown description&gt;', dbxrefs: Optional[List[str]] = None, features: Optional[List[ForwardRef('SeqFeature')]] = None, annotations: Optional[Dict[str, Union[str, int]]] = None, letter_annotations: Optional[Dict[str, Sequence[Any]]] = None) -&gt; None
 |  
 |  A SeqRecord object holds a sequence and information about it.
 |  
 |  Main attributes:
 |   - id          - Identifier such as a locus tag (string)
 |   - seq         - The sequence itself (Seq object or similar)
 |  
 |  Additional attributes:
 |   - name        - Sequence name, e.g. gene name (string)
 |   - description - Additional text (string)
 |   - dbxrefs     - List of database cross references (list of strings)
 |   - features    - Any (sub)features defined (list of SeqFeature objects)
 |   - annotations - Further information about the whole sequence (dictionary).
 |     Most entries are strings, or lists of strings.
 |   - letter_annotations - Per letter/symbol annotation (restricted
 |     dictionary). This holds Python sequences (lists, strings
 |     or tuples) whose length matches that of the sequence.
 |     A typical use would be to hold a list of integers
 |     representing sequencing quality scores, or a string
 |     representing the secondary structure.
 |  
 |  You will typically use Bio.SeqIO to read in sequences from files as
 |  SeqRecord objects.  However, you may want to create your own SeqRecord
 |  objects directly (see the __init__ method for further details):
 |  
 |  &gt;&gt;&gt; from Bio.Seq import Seq
 |  &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |  &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |  ...                    id="YP_025292.1", name="HokC",
 |  ...                    description="toxic membrane protein")
 |  &gt;&gt;&gt; print(record)
 |  ID: YP_025292.1
 |  Name: HokC
 |  Description: toxic membrane protein
 |  Number of features: 0
 |  Seq('MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF')
 |  
 |  If you want to save SeqRecord objects to a sequence file, use Bio.SeqIO
 |  for this.  For the special case where you want the SeqRecord turned into
 |  a string in a particular file format there is a format method which uses
 |  Bio.SeqIO internally:
 |  
 |  &gt;&gt;&gt; print(record.format("fasta"))
 |  &gt;YP_025292.1 toxic membrane protein
 |  MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |  &lt;BLANKLINE&gt;
 |  
 |  You can also do things like slicing a SeqRecord, checking its length, etc
 |  
 |  &gt;&gt;&gt; len(record)
 |  44
 |  &gt;&gt;&gt; edited = record[:10] + record[11:]
 |  &gt;&gt;&gt; print(edited.seq)
 |  MKQHKAMIVAIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |  &gt;&gt;&gt; print(record.seq)
 |  MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |  
 |  Methods defined here:
 |  
 |  __add__(self, other: Union[ForwardRef('SeqRecord'), ForwardRef('Seq'), ForwardRef('MutableSeq'), str]) -&gt; 'SeqRecord'
 |      Add another sequence or string to this sequence.
 |      
 |      The other sequence can be a SeqRecord object, a Seq object (or
 |      similar, e.g. a MutableSeq) or a plain Python string. If you add
 |      a plain string or a Seq (like) object, the new SeqRecord will simply
 |      have this appended to the existing data. However, any per letter
 |      annotation will be lost:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      
 |      &gt;&gt;&gt; new = record + "ACT"
 |      &gt;&gt;&gt; print("%s %s" % (new.id, new.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNNACT
 |      &gt;&gt;&gt; print(list(new.letter_annotations))
 |      []
 |      
 |      The new record will attempt to combine the annotation, but for any
 |      ambiguities (e.g. different names) it defaults to omitting that
 |      annotation.
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; with open("GenBank/pBAD30.gb") as handle:
 |      ...     plasmid = SeqIO.read(handle, "gb")
 |      &gt;&gt;&gt; print("%s %i" % (plasmid.id, len(plasmid)))
 |      pBAD30 4923
 |      
 |      Now let's cut the plasmid into two pieces, and join them back up the
 |      other way round (i.e. shift the starting point on this plasmid, have
 |      a look at the annotated features in the original file to see why this
 |      particular split point might make sense):
 |      
 |      &gt;&gt;&gt; left = plasmid[:3765]
 |      &gt;&gt;&gt; right = plasmid[3765:]
 |      &gt;&gt;&gt; new = right + left
 |      &gt;&gt;&gt; print("%s %i" % (new.id, len(new)))
 |      pBAD30 4923
 |      &gt;&gt;&gt; str(new.seq) == str(right.seq + left.seq)
 |      True
 |      &gt;&gt;&gt; len(new.features) == len(left.features) + len(right.features)
 |      True
 |      
 |      When we add the left and right SeqRecord objects, their annotation
 |      is all consistent, so it is all conserved in the new SeqRecord:
 |      
 |      &gt;&gt;&gt; new.id == left.id == right.id == plasmid.id
 |      True
 |      &gt;&gt;&gt; new.name == left.name == right.name == plasmid.name
 |      True
 |      &gt;&gt;&gt; new.description == plasmid.description
 |      True
 |      &gt;&gt;&gt; new.annotations == left.annotations == right.annotations
 |      True
 |      &gt;&gt;&gt; new.letter_annotations == plasmid.letter_annotations
 |      True
 |      &gt;&gt;&gt; new.dbxrefs == left.dbxrefs == right.dbxrefs
 |      True
 |      
 |      However, we should point out that when we sliced the SeqRecord,
 |      any annotations dictionary or dbxrefs list entries were lost.
 |      You can explicitly copy them like this:
 |      
 |      &gt;&gt;&gt; new.annotations = plasmid.annotations.copy()
 |      &gt;&gt;&gt; new.dbxrefs = plasmid.dbxrefs[:]
 |  
 |  __bool__(self) -&gt; bool
 |      Boolean value of an instance of this class (True).
 |      
 |      This behaviour is for backwards compatibility, since until the
 |      __len__ method was added, a SeqRecord always evaluated as True.
 |      
 |      Note that in comparison, a Seq object will evaluate to False if it
 |      has a zero length sequence.
 |      
 |      WARNING: The SeqRecord may in future evaluate to False when its
 |      sequence is of zero length (in order to better match the Seq
 |      object behaviour)!
 |  
 |  __bytes__(self) -&gt; bytes
 |  
 |  __contains__(self, char: str) -&gt; bool
 |      Implement the 'in' keyword, searches the sequence.
 |      
 |      e.g.
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/sweetpea.nu", "fasta")
 |      &gt;&gt;&gt; "GAATTC" in record
 |      False
 |      &gt;&gt;&gt; "AAA" in record
 |      True
 |      
 |      This essentially acts as a proxy for using "in" on the sequence:
 |      
 |      &gt;&gt;&gt; "GAATTC" in record.seq
 |      False
 |      &gt;&gt;&gt; "AAA" in record.seq
 |      True
 |      
 |      Note that you can also use Seq objects as the query,
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; Seq("AAA") in record
 |      True
 |      
 |      See also the Seq object's __contains__ method.
 |  
 |  __eq__(self, other: object) -&gt; NoReturn
 |      Define the equal-to operand (not implemented).
 |  
 |  __format__(self, format_spec: str) -&gt; str
 |      Return the record as a string in the specified file format.
 |      
 |      This method supports the Python format() function and f-strings.
 |      The format_spec should be a lower case string supported by
 |      Bio.SeqIO as a text output file format. Requesting a binary file
 |      format raises a ValueError. e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |      ...                    id="YP_025292.1", name="HokC",
 |      ...                    description="toxic membrane protein")
 |      ...
 |      &gt;&gt;&gt; format(record, "fasta")
 |      '&gt;YP_025292.1 toxic membrane protein\nMKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF\n'
 |      &gt;&gt;&gt; print(f"Here is {record.id} in FASTA format:\n{record:fasta}")
 |      Here is YP_025292.1 in FASTA format:
 |      &gt;YP_025292.1 toxic membrane protein
 |      MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |      &lt;BLANKLINE&gt;
 |      
 |      See also the SeqRecord's format() method.
 |  
 |  __ge__(self, other: Any) -&gt; NoReturn
 |      Define the greater-than-or-equal-to operand (not implemented).
 |  
 |  __getitem__(self, index)
 |      Return a sub-sequence or an individual letter.
 |      
 |      Slicing, e.g. my_record[5:10], returns a new SeqRecord for
 |      that sub-sequence with some annotation preserved as follows:
 |      
 |      * The name, id and description are kept as-is.
 |      * Any per-letter-annotations are sliced to match the requested
 |        sub-sequence.
 |      * Unless a stride is used, all those features which fall fully
 |        within the subsequence are included (with their locations
 |        adjusted accordingly). If you want to preserve any truncated
 |        features (e.g. GenBank/EMBL source features), you must
 |        explicitly add them to the new SeqRecord yourself.
 |      * With the exception of any molecule type, the annotations
 |        dictionary and the dbxrefs list are not used for the new
 |        SeqRecord, as in general they may not apply to the
 |        subsequence. If you want to preserve them, you must explicitly
 |        copy them to the new SeqRecord yourself.
 |      
 |      Using an integer index, e.g. my_record[5] is shorthand for
 |      extracting that letter from the sequence, my_record.seq[5].
 |      
 |      For example, consider this short protein and its secondary
 |      structure as encoded by the PDB (e.g. H for alpha helices),
 |      plus a simple feature for its histidine self phosphorylation
 |      site:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; from Bio.SeqFeature import SeqFeature, SimpleLocation
 |      &gt;&gt;&gt; rec = SeqRecord(Seq("MAAGVKQLADDRTLLMAGVSHDLRTPLTRIRLAT"
 |      ...                     "EMMSEQDGYLAESINKDIEECNAIIEQFIDYLR"),
 |      ...                 id="1JOY", name="EnvZ",
 |      ...                 description="Homodimeric domain of EnvZ from E. coli")
 |      &gt;&gt;&gt; rec.letter_annotations["secondary_structure"] = "  S  SSSSSSHHHHHTTTHHHHHHHHHHHHHHHHHHHHHHTHHHHHHHHHHHHHHHHHHHHHTT  "
 |      &gt;&gt;&gt; rec.features.append(SeqFeature(SimpleLocation(20, 21),
 |      ...                     type = "Site"))
 |      
 |      Now let's have a quick look at the full record,
 |      
 |      &gt;&gt;&gt; print(rec)
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 1
 |      Per letter annotation for: secondary_structure
 |      Seq('MAAGVKQLADDRTLLMAGVSHDLRTPLTRIRLATEMMSEQDGYLAESINKDIEE...YLR')
 |      &gt;&gt;&gt; rec.letter_annotations["secondary_structure"]
 |      '  S  SSSSSSHHHHHTTTHHHHHHHHHHHHHHHHHHHHHHTHHHHHHHHHHHHHHHHHHHHHTT  '
 |      &gt;&gt;&gt; print(rec.features[0].location)
 |      [20:21]
 |      
 |      Now let's take a sub sequence, here chosen as the first (fractured)
 |      alpha helix which includes the histidine phosphorylation site:
 |      
 |      &gt;&gt;&gt; sub = rec[11:41]
 |      &gt;&gt;&gt; print(sub)
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 1
 |      Per letter annotation for: secondary_structure
 |      Seq('RTLLMAGVSHDLRTPLTRIRLATEMMSEQD')
 |      &gt;&gt;&gt; sub.letter_annotations["secondary_structure"]
 |      'HHHHHTTTHHHHHHHHHHHHHHHHHHHHHH'
 |      &gt;&gt;&gt; print(sub.features[0].location)
 |      [9:10]
 |      
 |      You can also of course omit the start or end values, for
 |      example to get the first ten letters only:
 |      
 |      &gt;&gt;&gt; print(rec[:10])
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 0
 |      Per letter annotation for: secondary_structure
 |      Seq('MAAGVKQLAD')
 |      
 |      Or for the last ten letters:
 |      
 |      &gt;&gt;&gt; print(rec[-10:])
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 0
 |      Per letter annotation for: secondary_structure
 |      Seq('IIEQFIDYLR')
 |      
 |      If you omit both, then you get a copy of the original record (although
 |      lacking the annotations and dbxrefs):
 |      
 |      &gt;&gt;&gt; print(rec[:])
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 1
 |      Per letter annotation for: secondary_structure
 |      Seq('MAAGVKQLADDRTLLMAGVSHDLRTPLTRIRLATEMMSEQDGYLAESINKDIEE...YLR')
 |      
 |      Finally, indexing with a simple integer is shorthand for pulling out
 |      that letter from the sequence directly:
 |      
 |      &gt;&gt;&gt; rec[5]
 |      'K'
 |      &gt;&gt;&gt; rec.seq[5]
 |      'K'
 |  
 |  __gt__(self, other: Any) -&gt; NoReturn
 |      Define the greater-than operand (not implemented).
 |  
 |  __init__(self, seq: Union[ForwardRef('Seq'), ForwardRef('MutableSeq'), NoneType], id: Optional[str] = '&lt;unknown id&gt;', name: str = '&lt;unknown name&gt;', description: str = '&lt;unknown description&gt;', dbxrefs: Optional[List[str]] = None, features: Optional[List[ForwardRef('SeqFeature')]] = None, annotations: Optional[Dict[str, Union[str, int]]] = None, letter_annotations: Optional[Dict[str, Sequence[Any]]] = None) -&gt; None
 |      Create a SeqRecord.
 |      
 |      Arguments:
 |       - seq         - Sequence, required (Seq or MutableSeq)
 |       - id          - Sequence identifier, recommended (string)
 |       - name        - Sequence name, optional (string)
 |       - description - Sequence description, optional (string)
 |       - dbxrefs     - Database cross references, optional (list of strings)
 |       - features    - Any (sub)features, optional (list of SeqFeature objects)
 |       - annotations - Dictionary of annotations for the whole sequence
 |       - letter_annotations - Dictionary of per-letter-annotations, values
 |         should be strings, list or tuples of the same length as the full
 |         sequence.
 |      
 |      You will typically use Bio.SeqIO to read in sequences from files as
 |      SeqRecord objects.  However, you may want to create your own SeqRecord
 |      objects directly.
 |      
 |      Note that while an id is optional, we strongly recommend you supply a
 |      unique id string for each record.  This is especially important
 |      if you wish to write your sequences to a file.
 |      
 |      You can create a 'blank' SeqRecord object, and then populate the
 |      attributes later.
 |  
 |  __iter__(self) -&gt; Iterable[Union[ForwardRef('Seq'), ForwardRef('MutableSeq')]]
 |      Iterate over the letters in the sequence.
 |      
 |      For example, using Bio.SeqIO to read in a protein FASTA file:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/loveliesbleeding.pro", "fasta")
 |      &gt;&gt;&gt; for amino in record:
 |      ...     print(amino)
 |      ...     if amino == "L": break
 |      X
 |      A
 |      G
 |      L
 |      &gt;&gt;&gt; print(record.seq[3])
 |      L
 |      
 |      This is just a shortcut for iterating over the sequence directly:
 |      
 |      &gt;&gt;&gt; for amino in record.seq:
 |      ...     print(amino)
 |      ...     if amino == "L": break
 |      X
 |      A
 |      G
 |      L
 |      &gt;&gt;&gt; print(record.seq[3])
 |      L
 |      
 |      Note that this does not facilitate iteration together with any
 |      per-letter-annotation.  However, you can achieve that using the
 |      python zip function on the record (or its sequence) and the relevant
 |      per-letter-annotation:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; rec = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (rec.id, rec.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(rec.letter_annotations))
 |      ['solexa_quality']
 |      &gt;&gt;&gt; for nuc, qual in zip(rec, rec.letter_annotations["solexa_quality"]):
 |      ...     if qual &gt; 35:
 |      ...         print("%s %i" % (nuc, qual))
 |      A 40
 |      C 39
 |      G 38
 |      T 37
 |      A 36
 |      
 |      You may agree that using zip(rec.seq, ...) is more explicit than using
 |      zip(rec, ...) as shown above.
 |  
 |  __le__(self, other: Any) -&gt; NoReturn
 |      Define the less-than-or-equal-to operand (not implemented).
 |  
 |  __len__(self) -&gt; int
 |      Return the length of the sequence.
 |      
 |      For example, using Bio.SeqIO to read in a FASTA nucleotide file:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/sweetpea.nu", "fasta")
 |      &gt;&gt;&gt; len(record)
 |      309
 |      &gt;&gt;&gt; len(record.seq)
 |      309
 |  
 |  __lt__(self, other: Any) -&gt; NoReturn
 |      Define the less-than operand (not implemented).
 |  
 |  __ne__(self, other: object) -&gt; NoReturn
 |      Define the not-equal-to operand (not implemented).
 |  
 |  __radd__(self, other: Union[ForwardRef('Seq'), ForwardRef('MutableSeq'), str]) -&gt; 'SeqRecord'
 |      Add another sequence or string to this sequence (from the left).
 |      
 |      This method handles adding a Seq object (or similar, e.g. MutableSeq)
 |      or a plain Python string (on the left) to a SeqRecord (on the right).
 |      See the __add__ method for more details, but for example:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      
 |      &gt;&gt;&gt; new = "ACT" + record
 |      &gt;&gt;&gt; print("%s %s" % (new.id, new.seq))
 |      slxa_0001_1_0001_01 ACTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(new.letter_annotations))
 |      []
 |  
 |  __repr__(self) -&gt; str
 |      Return a concise summary of the record for debugging (string).
 |      
 |      The python built in function repr works by calling the object's __repr__
 |      method.  e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; rec = SeqRecord(Seq("MASRGVNKVILVGNLGQDPEVRYMPNGGAVANITLATSESWRDKAT"
 |      ...                     "GEMKEQTEWHRVVLFGKLAEVASEYLRKGSQVYIEGQLRTRKWTDQ"
 |      ...                     "SGQDRYTTEVVVNVGGTMQMLGGRQGGGAPAGGNIGGGQPQGGWGQ"
 |      ...                     "PQQPQGGNQFSGGAQSRPQQSAPAAPSNEPPMDFDDDIPF"),
 |      ...                 id="NP_418483.1", name="b4059",
 |      ...                 description="ssDNA-binding protein",
 |      ...                 dbxrefs=["ASAP:13298", "GI:16131885", "GeneID:948570"])
 |      &gt;&gt;&gt; print(repr(rec))
 |      SeqRecord(seq=Seq('MASRGVNKVILVGNLGQDPEVRYMPNGGAVANITLATSESWRDKATGEMKEQTE...IPF'), id='NP_418483.1', name='b4059', description='ssDNA-binding protein', dbxrefs=['ASAP:13298', 'GI:16131885', 'GeneID:948570'])
 |      
 |      At the python prompt you can also use this shorthand:
 |      
 |      &gt;&gt;&gt; rec
 |      SeqRecord(seq=Seq('MASRGVNKVILVGNLGQDPEVRYMPNGGAVANITLATSESWRDKATGEMKEQTE...IPF'), id='NP_418483.1', name='b4059', description='ssDNA-binding protein', dbxrefs=['ASAP:13298', 'GI:16131885', 'GeneID:948570'])
 |      
 |      Note that long sequences are shown truncated. Also note that any
 |      annotations, letter_annotations and features are not shown (as they
 |      would lead to a very long string).
 |  
 |  __str__(self) -&gt; str
 |      Return a human readable summary of the record and its annotation (string).
 |      
 |      The python built in function str works by calling the object's __str__
 |      method.  e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |      ...                    id="YP_025292.1", name="HokC",
 |      ...                    description="toxic membrane protein, small")
 |      &gt;&gt;&gt; print(str(record))
 |      ID: YP_025292.1
 |      Name: HokC
 |      Description: toxic membrane protein, small
 |      Number of features: 0
 |      Seq('MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF')
 |      
 |      In this example you don't actually need to call str explicitly, as the
 |      print command does this automatically:
 |      
 |      &gt;&gt;&gt; print(record)
 |      ID: YP_025292.1
 |      Name: HokC
 |      Description: toxic membrane protein, small
 |      Number of features: 0
 |      Seq('MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF')
 |      
 |      Note that long sequences are shown truncated.
 |  
 |  count(self, sub, start=None, end=None)
 |      Return the number of non-overlapping occurrences of sub in seq[start:end].
 |      
 |      Optional arguments start and end are interpreted as in slice notation.
 |      This method behaves as the count method of Python strings.
 |  
 |  format(self, format: str) -&gt; str
 |      Return the record as a string in the specified file format.
 |      
 |      The format should be a lower case string supported as an output
 |      format by Bio.SeqIO, which is used to turn the SeqRecord into a
 |      string.  e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |      ...                    id="YP_025292.1", name="HokC",
 |      ...                    description="toxic membrane protein")
 |      &gt;&gt;&gt; record.format("fasta")
 |      '&gt;YP_025292.1 toxic membrane protein\nMKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF\n'
 |      &gt;&gt;&gt; print(record.format("fasta"))
 |      &gt;YP_025292.1 toxic membrane protein
 |      MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |      &lt;BLANKLINE&gt;
 |      
 |      The Python print function automatically appends a new line, meaning
 |      in this example a blank line is shown.  If you look at the string
 |      representation you can see there is a trailing new line (shown as
 |      slash n) which is important when writing to a file or if
 |      concatenating multiple sequence strings together.
 |      
 |      Note that this method will NOT work on every possible file format
 |      supported by Bio.SeqIO (e.g. some are for multiple sequences only,
 |      and binary formats are not supported).
 |  
 |  islower(self)
 |      Return True if all ASCII characters in the record's sequence are lowercase.
 |      
 |      If there are no cased characters, the method returns False.
 |  
 |  isupper(self)
 |      Return True if all ASCII characters in the record's sequence are uppercase.
 |      
 |      If there are no cased characters, the method returns False.
 |  
 |  lower(self) -&gt; 'SeqRecord'
 |      Return a copy of the record with a lower case sequence.
 |      
 |      All the annotation is preserved unchanged. e.g.
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/aster.pro", "fasta")
 |      &gt;&gt;&gt; print(record.format("fasta"))
 |      &gt;gi|3298468|dbj|BAA31520.1| SAMIPF
 |      GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG
 |      VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI
 |      &lt;BLANKLINE&gt;
 |      &gt;&gt;&gt; print(record.lower().format("fasta"))
 |      &gt;gi|3298468|dbj|BAA31520.1| SAMIPF
 |      gghvnpavtfgafvggnitllrgivyiiaqllgstvaclllkfvtndmavgvfslsagvg
 |      vtnalvfeivmtfglvytvyataidpkkgslgtiapiaigfivgani
 |      &lt;BLANKLINE&gt;
 |      
 |      To take a more annotation rich example,
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; old = SeqIO.read("EMBL/TRBG361.embl", "embl")
 |      &gt;&gt;&gt; len(old.features)
 |      3
 |      &gt;&gt;&gt; new = old.lower()
 |      &gt;&gt;&gt; len(old.features) == len(new.features)
 |      True
 |      &gt;&gt;&gt; old.annotations["organism"] == new.annotations["organism"]
 |      True
 |      &gt;&gt;&gt; old.dbxrefs == new.dbxrefs
 |      True
 |  
 |  reverse_complement(self, id: bool = False, name: bool = False, description: bool = False, features: bool = True, annotations: bool = False, letter_annotations: bool = True, dbxrefs: bool = False) -&gt; 'SeqRecord'
 |      Return new SeqRecord with reverse complement sequence.
 |      
 |      By default the new record does NOT preserve the sequence identifier,
 |      name, description, general annotation or database cross-references -
 |      these are unlikely to apply to the reversed sequence.
 |      
 |      You can specify the returned record's id, name and description as
 |      strings, or True to keep that of the parent, or False for a default.
 |      
 |      You can specify the returned record's features with a list of
 |      SeqFeature objects, or True to keep that of the parent, or False to
 |      omit them. The default is to keep the original features (with the
 |      strand and locations adjusted).
 |      
 |      You can also specify both the returned record's annotations and
 |      letter_annotations as dictionaries, True to keep that of the parent,
 |      or False to omit them. The default is to keep the original
 |      annotations (with the letter annotations reversed).
 |      
 |      To show what happens to the pre-letter annotations, consider an
 |      example Solexa variant FASTQ file with a single entry, which we'll
 |      read in as a SeqRecord:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      &gt;&gt;&gt; print(record.letter_annotations["solexa_quality"])
 |      [40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5]
 |      
 |      Now take the reverse complement, here we explicitly give a new
 |      identifier (the old identifier with a suffix):
 |      
 |      &gt;&gt;&gt; rc_record = record.reverse_complement(id=record.id + "_rc")
 |      &gt;&gt;&gt; print("%s %s" % (rc_record.id, rc_record.seq))
 |      slxa_0001_1_0001_01_rc NNNNNNACGTACGTACGTACGTACGTACGTACGTACGTACGTACGT
 |      
 |      Notice that the per-letter-annotations have also been reversed,
 |      although this may not be appropriate for all cases.
 |      
 |      &gt;&gt;&gt; print(rc_record.letter_annotations["solexa_quality"])
 |      [-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
 |      
 |      Now for the features, we need a different example. Parsing a GenBank
 |      file is probably the easiest way to get an nice example with features
 |      in it...
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; with open("GenBank/pBAD30.gb") as handle:
 |      ...     plasmid = SeqIO.read(handle, "gb")
 |      &gt;&gt;&gt; print("%s %i" % (plasmid.id, len(plasmid)))
 |      pBAD30 4923
 |      &gt;&gt;&gt; plasmid.seq
 |      Seq('GCTAGCGGAGTGTATACTGGCTTACTATGTTGGCACTGATGAGGGTGTCAGTGA...ATG')
 |      &gt;&gt;&gt; len(plasmid.features)
 |      13
 |      
 |      Now, let's take the reverse complement of this whole plasmid:
 |      
 |      &gt;&gt;&gt; rc_plasmid = plasmid.reverse_complement(id=plasmid.id+"_rc")
 |      &gt;&gt;&gt; print("%s %i" % (rc_plasmid.id, len(rc_plasmid)))
 |      pBAD30_rc 4923
 |      &gt;&gt;&gt; rc_plasmid.seq
 |      Seq('CATGGGCAAATATTATACGCAAGGCGACAAGGTGCTGATGCCGCTGGCGATTCA...AGC')
 |      &gt;&gt;&gt; len(rc_plasmid.features)
 |      13
 |      
 |      Let's compare the first CDS feature - it has gone from being the
 |      second feature (index 1) to the second last feature (index -2), its
 |      strand has changed, and the location switched round.
 |      
 |      &gt;&gt;&gt; print(plasmid.features[1])
 |      type: CDS
 |      location: [1081:1960](-)
 |      qualifiers:
 |          Key: label, Value: ['araC']
 |          Key: note, Value: ['araC regulator of the arabinose BAD promoter']
 |          Key: vntifkey, Value: ['4']
 |      &lt;BLANKLINE&gt;
 |      &gt;&gt;&gt; print(rc_plasmid.features[-2])
 |      type: CDS
 |      location: [2963:3842](+)
 |      qualifiers:
 |          Key: label, Value: ['araC']
 |          Key: note, Value: ['araC regulator of the arabinose BAD promoter']
 |          Key: vntifkey, Value: ['4']
 |      &lt;BLANKLINE&gt;
 |      
 |      You can check this new location, based on the length of the plasmid:
 |      
 |      &gt;&gt;&gt; len(plasmid) - 1081
 |      3842
 |      &gt;&gt;&gt; len(plasmid) - 1960
 |      2963
 |      
 |      Note that if the SeqFeature annotation includes any strand specific
 |      information (e.g. base changes for a SNP), this information is not
 |      amended, and would need correction after the reverse complement.
 |      
 |      Note trying to reverse complement a protein SeqRecord raises an
 |      exception:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; protein_rec = SeqRecord(Seq("MAIVMGR"), id="Test",
 |      ...                         annotations={"molecule_type": "protein"})
 |      &gt;&gt;&gt; protein_rec.reverse_complement()
 |      Traceback (most recent call last):
 |         ...
 |      ValueError: Proteins do not have complements!
 |      
 |      If you have RNA without any U bases, it must be annotated as RNA
 |      otherwise it will be treated as DNA by default with A mapped to T:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; rna1 = SeqRecord(Seq("ACG"), id="Test")
 |      &gt;&gt;&gt; rna2 = SeqRecord(Seq("ACG"), id="Test", annotations={"molecule_type": "RNA"})
 |      &gt;&gt;&gt; print(rna1.reverse_complement(id="RC", description="unk").format("fasta"))
 |      &gt;RC unk
 |      CGT
 |      &lt;BLANKLINE&gt;
 |      &gt;&gt;&gt; print(rna2.reverse_complement(id="RC", description="RNA").format("fasta"))
 |      &gt;RC RNA
 |      CGU
 |      &lt;BLANKLINE&gt;
 |      
 |      Also note you can reverse complement a SeqRecord using a MutableSeq:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import MutableSeq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; rec = SeqRecord(MutableSeq("ACGT"), id="Test")
 |      &gt;&gt;&gt; rec.seq[0] = "T"
 |      &gt;&gt;&gt; print("%s %s" % (rec.id, rec.seq))
 |      Test TCGT
 |      &gt;&gt;&gt; rc = rec.reverse_complement(id=True)
 |      &gt;&gt;&gt; print("%s %s" % (rc.id, rc.seq))
 |      Test ACGA
 |  
 |  translate(self, table: str = 'Standard', stop_symbol: str = '*', to_stop: bool = False, cds: bool = False, gap: Optional[str] = None, id: bool = False, name: bool = False, description: bool = False, features: bool = False, annotations: bool = False, letter_annotations: bool = False, dbxrefs: bool = False) -&gt; 'SeqRecord'
 |      Return new SeqRecord with translated sequence.
 |      
 |      This calls the record's .seq.translate() method (which describes
 |      the translation related arguments, like table for the genetic code),
 |      
 |      By default the new record does NOT preserve the sequence identifier,
 |      name, description, general annotation or database cross-references -
 |      these are unlikely to apply to the translated sequence.
 |      
 |      You can specify the returned record's id, name and description as
 |      strings, or True to keep that of the parent, or False for a default.
 |      
 |      You can specify the returned record's features with a list of
 |      SeqFeature objects, or False (default) to omit them.
 |      
 |      You can also specify both the returned record's annotations and
 |      letter_annotations as dictionaries, True to keep that of the parent
 |      (annotations only), or False (default) to omit them.
 |      
 |      e.g. Loading a FASTA gene and translating it,
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; gene_record = SeqIO.read("Fasta/sweetpea.nu", "fasta")
 |      &gt;&gt;&gt; print(gene_record.format("fasta"))
 |      &gt;gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds
 |      CAGGCTGCGCGGTTTCTATTTATGAAGAACAAGGTCCGTATGATAGTTGATTGTCATGCA
 |      AAACATGTGAAGGTTCTTCAAGACGAAAAACTCCCATTTGATTTGACTCTGTGCGGTTCG
 |      ACCTTAAGAGCTCCACATAGTTGCCATTTGCAGTACATGGCTAACATGGATTCAATTGCT
 |      TCATTGGTTATGGCAGTGGTCGTCAATGACAGCGATGAAGATGGAGATAGCCGTGACGCA
 |      GTTCTACCACAAAAGAAAAAGAGACTTTGGGGTTTGGTAGTTTGTCATAACACTACTCCG
 |      AGGTTTGTT
 |      &lt;BLANKLINE&gt;
 |      
 |      And now translating the record, specifying the new ID and description:
 |      
 |      &gt;&gt;&gt; protein_record = gene_record.translate(table=11,
 |      ...                                        id="phya",
 |      ...                                        description="translation")
 |      &gt;&gt;&gt; print(protein_record.format("fasta"))
 |      &gt;phya translation
 |      QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
 |      SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV
 |      &lt;BLANKLINE&gt;
 |  
 |  upper(self) -&gt; 'SeqRecord'
 |      Return a copy of the record with an upper case sequence.
 |      
 |      All the annotation is preserved unchanged. e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("acgtACGT"), id="Test",
 |      ...                    description = "Made up for this example")
 |      &gt;&gt;&gt; record.letter_annotations["phred_quality"] = [1, 2, 3, 4, 5, 6, 7, 8]
 |      &gt;&gt;&gt; print(record.upper().format("fastq"))
 |      @Test Made up for this example
 |      ACGTACGT
 |      +
 |      "#$%&amp;'()
 |      &lt;BLANKLINE&gt;
 |      
 |      Naturally, there is a matching lower method:
 |      
 |      &gt;&gt;&gt; print(record.lower().format("fastq"))
 |      @Test Made up for this example
 |      acgtacgt
 |      +
 |      "#$%&amp;'()
 |      &lt;BLANKLINE&gt;
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |  
 |  __dict__
 |      dictionary for instance variables (if defined)
 |  
 |  __weakref__
 |      list of weak references to the object (if defined)
 |  
 |  letter_annotations
 |      Dictionary of per-letter-annotation for the sequence.
 |      
 |      For example, this can hold quality scores used in FASTQ or QUAL files.
 |      Consider this example using Bio.SeqIO to read in an example Solexa
 |      variant FASTQ file as a SeqRecord:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      &gt;&gt;&gt; print(record.letter_annotations["solexa_quality"])
 |      [40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5]
 |      
 |      The letter_annotations get sliced automatically if you slice the
 |      parent SeqRecord, for example taking the last ten bases:
 |      
 |      &gt;&gt;&gt; sub_record = record[-10:]
 |      &gt;&gt;&gt; print("%s %s" % (sub_record.id, sub_record.seq))
 |      slxa_0001_1_0001_01 ACGTNNNNNN
 |      &gt;&gt;&gt; print(sub_record.letter_annotations["solexa_quality"])
 |      [4, 3, 2, 1, 0, -1, -2, -3, -4, -5]
 |      
 |      Any python sequence (i.e. list, tuple or string) can be recorded in
 |      the SeqRecord's letter_annotations dictionary as long as the length
 |      matches that of the SeqRecord's sequence.  e.g.
 |      
 |      &gt;&gt;&gt; len(sub_record.letter_annotations)
 |      1
 |      &gt;&gt;&gt; sub_record.letter_annotations["dummy"] = "abcdefghij"
 |      &gt;&gt;&gt; len(sub_record.letter_annotations)
 |      2
 |      
 |      You can delete entries from the letter_annotations dictionary as usual:
 |      
 |      &gt;&gt;&gt; del sub_record.letter_annotations["solexa_quality"]
 |      &gt;&gt;&gt; sub_record.letter_annotations
 |      {'dummy': 'abcdefghij'}
 |      
 |      You can completely clear the dictionary easily as follows:
 |      
 |      &gt;&gt;&gt; sub_record.letter_annotations = {}
 |      &gt;&gt;&gt; sub_record.letter_annotations
 |      {}
 |      
 |      Note that if replacing the record's sequence with a sequence of a
 |      different length you must first clear the letter_annotations dict.
 |  
 |  seq
 |      The sequence itself, as a Seq or MutableSeq object.
 |  
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |  
 |  __annotations__ = {'annotations': typing.Dict[str, typing.Union[str, i...
 |  
 |  __hash__ = None
</code></pre>
</div>
</div>
<ul>
<li>class 개념 이해 필요</li>
</ul>
<div id="cell-25" class="cell" data-outputid="97c9801f-4167-4f6f-b011-51c0bf9faf53">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>simple_seq_r.<span class="bu">id</span> <span class="op">=</span> <span class="st">"AC12345"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>simple_seq_r.description <span class="op">=</span> <span class="st">"Made up sequence I wish I could write a paper about"</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(simple_seq_r.description)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(simple_seq_r.seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Made up sequence I wish I could write a paper about
GATC</code></pre>
</div>
</div>
<ul>
<li>Read fasta file</li>
<li>https://www.ncbi.nlm.nih.gov/nuccore/MW015936.1</li>
<li>Zika virus isolate Zika virus/H.sapiens-tc/THA/2006/CVD_06-020, complete genome</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/zika.png" class="img-fluid figure-img"></p>
<figcaption>alt text</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>인용구 추가</p>
</blockquote>
<div id="cell-28" class="cell" data-executioninfo="{&quot;elapsed&quot;:730,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002833369,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>record <span class="op">=</span> SeqIO.read(<span class="st">"data/MW015936.gb"</span>, <span class="st">"gb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-29" class="cell" data-outputid="7123726a-125e-4fb0-95d8-03130793db4b">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(record)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ID: MW015936.1
Name: MW015936
Description: Zika virus isolate Zika virus/H.sapiens-tc/THA/2006/CVD_06-020, complete genome
Number of features: 17
/molecule_type=RNA
/topology=linear
/data_file_division=VRL
/date=12-OCT-2020
/accessions=['MW015936']
/sequence_version=1
/keywords=['']
/source=Zika virus
/organism=Zika virus
/taxonomy=['Viruses', 'Riboviria', 'Orthornavirae', 'Kitrinoviricota', 'Flasuviricetes', 'Amarillovirales', 'Flaviviridae', 'Orthoflavivirus', 'Orthoflavivirus zikaense']
/references=[Reference(title='Complete genome sequence of the Zika virus used for development of live-attenuated Zika virus strain', ...), Reference(title='Direct Submission', ...)]
/structured_comment=defaultdict(&lt;class 'dict'&gt;, {'Assembly-Data': {'Sequencing Technology': 'Sanger dideoxy sequencing'}})
Seq('AGTTGTTGATCTGTGTGAATCAGACTGCGACAGTTCGAGTTTGAAGCGAAAGCT...TCT')
Help on SeqRecord in module Bio.SeqRecord object:

class SeqRecord(builtins.object)
 |  SeqRecord(seq: Union[ForwardRef('Seq'), ForwardRef('MutableSeq'), NoneType], id: Optional[str] = '&lt;unknown id&gt;', name: str = '&lt;unknown name&gt;', description: str = '&lt;unknown description&gt;', dbxrefs: Optional[List[str]] = None, features: Optional[List[ForwardRef('SeqFeature')]] = None, annotations: Optional[Dict[str, Union[str, int]]] = None, letter_annotations: Optional[Dict[str, Sequence[Any]]] = None) -&gt; None
 |  
 |  A SeqRecord object holds a sequence and information about it.
 |  
 |  Main attributes:
 |   - id          - Identifier such as a locus tag (string)
 |   - seq         - The sequence itself (Seq object or similar)
 |  
 |  Additional attributes:
 |   - name        - Sequence name, e.g. gene name (string)
 |   - description - Additional text (string)
 |   - dbxrefs     - List of database cross references (list of strings)
 |   - features    - Any (sub)features defined (list of SeqFeature objects)
 |   - annotations - Further information about the whole sequence (dictionary).
 |     Most entries are strings, or lists of strings.
 |   - letter_annotations - Per letter/symbol annotation (restricted
 |     dictionary). This holds Python sequences (lists, strings
 |     or tuples) whose length matches that of the sequence.
 |     A typical use would be to hold a list of integers
 |     representing sequencing quality scores, or a string
 |     representing the secondary structure.
 |  
 |  You will typically use Bio.SeqIO to read in sequences from files as
 |  SeqRecord objects.  However, you may want to create your own SeqRecord
 |  objects directly (see the __init__ method for further details):
 |  
 |  &gt;&gt;&gt; from Bio.Seq import Seq
 |  &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |  &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |  ...                    id="YP_025292.1", name="HokC",
 |  ...                    description="toxic membrane protein")
 |  &gt;&gt;&gt; print(record)
 |  ID: YP_025292.1
 |  Name: HokC
 |  Description: toxic membrane protein
 |  Number of features: 0
 |  Seq('MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF')
 |  
 |  If you want to save SeqRecord objects to a sequence file, use Bio.SeqIO
 |  for this.  For the special case where you want the SeqRecord turned into
 |  a string in a particular file format there is a format method which uses
 |  Bio.SeqIO internally:
 |  
 |  &gt;&gt;&gt; print(record.format("fasta"))
 |  &gt;YP_025292.1 toxic membrane protein
 |  MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |  &lt;BLANKLINE&gt;
 |  
 |  You can also do things like slicing a SeqRecord, checking its length, etc
 |  
 |  &gt;&gt;&gt; len(record)
 |  44
 |  &gt;&gt;&gt; edited = record[:10] + record[11:]
 |  &gt;&gt;&gt; print(edited.seq)
 |  MKQHKAMIVAIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |  &gt;&gt;&gt; print(record.seq)
 |  MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |  
 |  Methods defined here:
 |  
 |  __add__(self, other: Union[ForwardRef('SeqRecord'), ForwardRef('Seq'), ForwardRef('MutableSeq'), str]) -&gt; 'SeqRecord'
 |      Add another sequence or string to this sequence.
 |      
 |      The other sequence can be a SeqRecord object, a Seq object (or
 |      similar, e.g. a MutableSeq) or a plain Python string. If you add
 |      a plain string or a Seq (like) object, the new SeqRecord will simply
 |      have this appended to the existing data. However, any per letter
 |      annotation will be lost:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      
 |      &gt;&gt;&gt; new = record + "ACT"
 |      &gt;&gt;&gt; print("%s %s" % (new.id, new.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNNACT
 |      &gt;&gt;&gt; print(list(new.letter_annotations))
 |      []
 |      
 |      The new record will attempt to combine the annotation, but for any
 |      ambiguities (e.g. different names) it defaults to omitting that
 |      annotation.
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; with open("GenBank/pBAD30.gb") as handle:
 |      ...     plasmid = SeqIO.read(handle, "gb")
 |      &gt;&gt;&gt; print("%s %i" % (plasmid.id, len(plasmid)))
 |      pBAD30 4923
 |      
 |      Now let's cut the plasmid into two pieces, and join them back up the
 |      other way round (i.e. shift the starting point on this plasmid, have
 |      a look at the annotated features in the original file to see why this
 |      particular split point might make sense):
 |      
 |      &gt;&gt;&gt; left = plasmid[:3765]
 |      &gt;&gt;&gt; right = plasmid[3765:]
 |      &gt;&gt;&gt; new = right + left
 |      &gt;&gt;&gt; print("%s %i" % (new.id, len(new)))
 |      pBAD30 4923
 |      &gt;&gt;&gt; str(new.seq) == str(right.seq + left.seq)
 |      True
 |      &gt;&gt;&gt; len(new.features) == len(left.features) + len(right.features)
 |      True
 |      
 |      When we add the left and right SeqRecord objects, their annotation
 |      is all consistent, so it is all conserved in the new SeqRecord:
 |      
 |      &gt;&gt;&gt; new.id == left.id == right.id == plasmid.id
 |      True
 |      &gt;&gt;&gt; new.name == left.name == right.name == plasmid.name
 |      True
 |      &gt;&gt;&gt; new.description == plasmid.description
 |      True
 |      &gt;&gt;&gt; new.annotations == left.annotations == right.annotations
 |      True
 |      &gt;&gt;&gt; new.letter_annotations == plasmid.letter_annotations
 |      True
 |      &gt;&gt;&gt; new.dbxrefs == left.dbxrefs == right.dbxrefs
 |      True
 |      
 |      However, we should point out that when we sliced the SeqRecord,
 |      any annotations dictionary or dbxrefs list entries were lost.
 |      You can explicitly copy them like this:
 |      
 |      &gt;&gt;&gt; new.annotations = plasmid.annotations.copy()
 |      &gt;&gt;&gt; new.dbxrefs = plasmid.dbxrefs[:]
 |  
 |  __bool__(self) -&gt; bool
 |      Boolean value of an instance of this class (True).
 |      
 |      This behaviour is for backwards compatibility, since until the
 |      __len__ method was added, a SeqRecord always evaluated as True.
 |      
 |      Note that in comparison, a Seq object will evaluate to False if it
 |      has a zero length sequence.
 |      
 |      WARNING: The SeqRecord may in future evaluate to False when its
 |      sequence is of zero length (in order to better match the Seq
 |      object behaviour)!
 |  
 |  __bytes__(self) -&gt; bytes
 |  
 |  __contains__(self, char: str) -&gt; bool
 |      Implement the 'in' keyword, searches the sequence.
 |      
 |      e.g.
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/sweetpea.nu", "fasta")
 |      &gt;&gt;&gt; "GAATTC" in record
 |      False
 |      &gt;&gt;&gt; "AAA" in record
 |      True
 |      
 |      This essentially acts as a proxy for using "in" on the sequence:
 |      
 |      &gt;&gt;&gt; "GAATTC" in record.seq
 |      False
 |      &gt;&gt;&gt; "AAA" in record.seq
 |      True
 |      
 |      Note that you can also use Seq objects as the query,
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; Seq("AAA") in record
 |      True
 |      
 |      See also the Seq object's __contains__ method.
 |  
 |  __eq__(self, other: object) -&gt; NoReturn
 |      Define the equal-to operand (not implemented).
 |  
 |  __format__(self, format_spec: str) -&gt; str
 |      Return the record as a string in the specified file format.
 |      
 |      This method supports the Python format() function and f-strings.
 |      The format_spec should be a lower case string supported by
 |      Bio.SeqIO as a text output file format. Requesting a binary file
 |      format raises a ValueError. e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |      ...                    id="YP_025292.1", name="HokC",
 |      ...                    description="toxic membrane protein")
 |      ...
 |      &gt;&gt;&gt; format(record, "fasta")
 |      '&gt;YP_025292.1 toxic membrane protein\nMKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF\n'
 |      &gt;&gt;&gt; print(f"Here is {record.id} in FASTA format:\n{record:fasta}")
 |      Here is YP_025292.1 in FASTA format:
 |      &gt;YP_025292.1 toxic membrane protein
 |      MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |      &lt;BLANKLINE&gt;
 |      
 |      See also the SeqRecord's format() method.
 |  
 |  __ge__(self, other: Any) -&gt; NoReturn
 |      Define the greater-than-or-equal-to operand (not implemented).
 |  
 |  __getitem__(self, index)
 |      Return a sub-sequence or an individual letter.
 |      
 |      Slicing, e.g. my_record[5:10], returns a new SeqRecord for
 |      that sub-sequence with some annotation preserved as follows:
 |      
 |      * The name, id and description are kept as-is.
 |      * Any per-letter-annotations are sliced to match the requested
 |        sub-sequence.
 |      * Unless a stride is used, all those features which fall fully
 |        within the subsequence are included (with their locations
 |        adjusted accordingly). If you want to preserve any truncated
 |        features (e.g. GenBank/EMBL source features), you must
 |        explicitly add them to the new SeqRecord yourself.
 |      * With the exception of any molecule type, the annotations
 |        dictionary and the dbxrefs list are not used for the new
 |        SeqRecord, as in general they may not apply to the
 |        subsequence. If you want to preserve them, you must explicitly
 |        copy them to the new SeqRecord yourself.
 |      
 |      Using an integer index, e.g. my_record[5] is shorthand for
 |      extracting that letter from the sequence, my_record.seq[5].
 |      
 |      For example, consider this short protein and its secondary
 |      structure as encoded by the PDB (e.g. H for alpha helices),
 |      plus a simple feature for its histidine self phosphorylation
 |      site:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; from Bio.SeqFeature import SeqFeature, SimpleLocation
 |      &gt;&gt;&gt; rec = SeqRecord(Seq("MAAGVKQLADDRTLLMAGVSHDLRTPLTRIRLAT"
 |      ...                     "EMMSEQDGYLAESINKDIEECNAIIEQFIDYLR"),
 |      ...                 id="1JOY", name="EnvZ",
 |      ...                 description="Homodimeric domain of EnvZ from E. coli")
 |      &gt;&gt;&gt; rec.letter_annotations["secondary_structure"] = "  S  SSSSSSHHHHHTTTHHHHHHHHHHHHHHHHHHHHHHTHHHHHHHHHHHHHHHHHHHHHTT  "
 |      &gt;&gt;&gt; rec.features.append(SeqFeature(SimpleLocation(20, 21),
 |      ...                     type = "Site"))
 |      
 |      Now let's have a quick look at the full record,
 |      
 |      &gt;&gt;&gt; print(rec)
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 1
 |      Per letter annotation for: secondary_structure
 |      Seq('MAAGVKQLADDRTLLMAGVSHDLRTPLTRIRLATEMMSEQDGYLAESINKDIEE...YLR')
 |      &gt;&gt;&gt; rec.letter_annotations["secondary_structure"]
 |      '  S  SSSSSSHHHHHTTTHHHHHHHHHHHHHHHHHHHHHHTHHHHHHHHHHHHHHHHHHHHHTT  '
 |      &gt;&gt;&gt; print(rec.features[0].location)
 |      [20:21]
 |      
 |      Now let's take a sub sequence, here chosen as the first (fractured)
 |      alpha helix which includes the histidine phosphorylation site:
 |      
 |      &gt;&gt;&gt; sub = rec[11:41]
 |      &gt;&gt;&gt; print(sub)
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 1
 |      Per letter annotation for: secondary_structure
 |      Seq('RTLLMAGVSHDLRTPLTRIRLATEMMSEQD')
 |      &gt;&gt;&gt; sub.letter_annotations["secondary_structure"]
 |      'HHHHHTTTHHHHHHHHHHHHHHHHHHHHHH'
 |      &gt;&gt;&gt; print(sub.features[0].location)
 |      [9:10]
 |      
 |      You can also of course omit the start or end values, for
 |      example to get the first ten letters only:
 |      
 |      &gt;&gt;&gt; print(rec[:10])
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 0
 |      Per letter annotation for: secondary_structure
 |      Seq('MAAGVKQLAD')
 |      
 |      Or for the last ten letters:
 |      
 |      &gt;&gt;&gt; print(rec[-10:])
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 0
 |      Per letter annotation for: secondary_structure
 |      Seq('IIEQFIDYLR')
 |      
 |      If you omit both, then you get a copy of the original record (although
 |      lacking the annotations and dbxrefs):
 |      
 |      &gt;&gt;&gt; print(rec[:])
 |      ID: 1JOY
 |      Name: EnvZ
 |      Description: Homodimeric domain of EnvZ from E. coli
 |      Number of features: 1
 |      Per letter annotation for: secondary_structure
 |      Seq('MAAGVKQLADDRTLLMAGVSHDLRTPLTRIRLATEMMSEQDGYLAESINKDIEE...YLR')
 |      
 |      Finally, indexing with a simple integer is shorthand for pulling out
 |      that letter from the sequence directly:
 |      
 |      &gt;&gt;&gt; rec[5]
 |      'K'
 |      &gt;&gt;&gt; rec.seq[5]
 |      'K'
 |  
 |  __gt__(self, other: Any) -&gt; NoReturn
 |      Define the greater-than operand (not implemented).
 |  
 |  __init__(self, seq: Union[ForwardRef('Seq'), ForwardRef('MutableSeq'), NoneType], id: Optional[str] = '&lt;unknown id&gt;', name: str = '&lt;unknown name&gt;', description: str = '&lt;unknown description&gt;', dbxrefs: Optional[List[str]] = None, features: Optional[List[ForwardRef('SeqFeature')]] = None, annotations: Optional[Dict[str, Union[str, int]]] = None, letter_annotations: Optional[Dict[str, Sequence[Any]]] = None) -&gt; None
 |      Create a SeqRecord.
 |      
 |      Arguments:
 |       - seq         - Sequence, required (Seq or MutableSeq)
 |       - id          - Sequence identifier, recommended (string)
 |       - name        - Sequence name, optional (string)
 |       - description - Sequence description, optional (string)
 |       - dbxrefs     - Database cross references, optional (list of strings)
 |       - features    - Any (sub)features, optional (list of SeqFeature objects)
 |       - annotations - Dictionary of annotations for the whole sequence
 |       - letter_annotations - Dictionary of per-letter-annotations, values
 |         should be strings, list or tuples of the same length as the full
 |         sequence.
 |      
 |      You will typically use Bio.SeqIO to read in sequences from files as
 |      SeqRecord objects.  However, you may want to create your own SeqRecord
 |      objects directly.
 |      
 |      Note that while an id is optional, we strongly recommend you supply a
 |      unique id string for each record.  This is especially important
 |      if you wish to write your sequences to a file.
 |      
 |      You can create a 'blank' SeqRecord object, and then populate the
 |      attributes later.
 |  
 |  __iter__(self) -&gt; Iterable[Union[ForwardRef('Seq'), ForwardRef('MutableSeq')]]
 |      Iterate over the letters in the sequence.
 |      
 |      For example, using Bio.SeqIO to read in a protein FASTA file:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/loveliesbleeding.pro", "fasta")
 |      &gt;&gt;&gt; for amino in record:
 |      ...     print(amino)
 |      ...     if amino == "L": break
 |      X
 |      A
 |      G
 |      L
 |      &gt;&gt;&gt; print(record.seq[3])
 |      L
 |      
 |      This is just a shortcut for iterating over the sequence directly:
 |      
 |      &gt;&gt;&gt; for amino in record.seq:
 |      ...     print(amino)
 |      ...     if amino == "L": break
 |      X
 |      A
 |      G
 |      L
 |      &gt;&gt;&gt; print(record.seq[3])
 |      L
 |      
 |      Note that this does not facilitate iteration together with any
 |      per-letter-annotation.  However, you can achieve that using the
 |      python zip function on the record (or its sequence) and the relevant
 |      per-letter-annotation:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; rec = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (rec.id, rec.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(rec.letter_annotations))
 |      ['solexa_quality']
 |      &gt;&gt;&gt; for nuc, qual in zip(rec, rec.letter_annotations["solexa_quality"]):
 |      ...     if qual &gt; 35:
 |      ...         print("%s %i" % (nuc, qual))
 |      A 40
 |      C 39
 |      G 38
 |      T 37
 |      A 36
 |      
 |      You may agree that using zip(rec.seq, ...) is more explicit than using
 |      zip(rec, ...) as shown above.
 |  
 |  __le__(self, other: Any) -&gt; NoReturn
 |      Define the less-than-or-equal-to operand (not implemented).
 |  
 |  __len__(self) -&gt; int
 |      Return the length of the sequence.
 |      
 |      For example, using Bio.SeqIO to read in a FASTA nucleotide file:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/sweetpea.nu", "fasta")
 |      &gt;&gt;&gt; len(record)
 |      309
 |      &gt;&gt;&gt; len(record.seq)
 |      309
 |  
 |  __lt__(self, other: Any) -&gt; NoReturn
 |      Define the less-than operand (not implemented).
 |  
 |  __ne__(self, other: object) -&gt; NoReturn
 |      Define the not-equal-to operand (not implemented).
 |  
 |  __radd__(self, other: Union[ForwardRef('Seq'), ForwardRef('MutableSeq'), str]) -&gt; 'SeqRecord'
 |      Add another sequence or string to this sequence (from the left).
 |      
 |      This method handles adding a Seq object (or similar, e.g. MutableSeq)
 |      or a plain Python string (on the left) to a SeqRecord (on the right).
 |      See the __add__ method for more details, but for example:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      
 |      &gt;&gt;&gt; new = "ACT" + record
 |      &gt;&gt;&gt; print("%s %s" % (new.id, new.seq))
 |      slxa_0001_1_0001_01 ACTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(new.letter_annotations))
 |      []
 |  
 |  __repr__(self) -&gt; str
 |      Return a concise summary of the record for debugging (string).
 |      
 |      The python built in function repr works by calling the object's __repr__
 |      method.  e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; rec = SeqRecord(Seq("MASRGVNKVILVGNLGQDPEVRYMPNGGAVANITLATSESWRDKAT"
 |      ...                     "GEMKEQTEWHRVVLFGKLAEVASEYLRKGSQVYIEGQLRTRKWTDQ"
 |      ...                     "SGQDRYTTEVVVNVGGTMQMLGGRQGGGAPAGGNIGGGQPQGGWGQ"
 |      ...                     "PQQPQGGNQFSGGAQSRPQQSAPAAPSNEPPMDFDDDIPF"),
 |      ...                 id="NP_418483.1", name="b4059",
 |      ...                 description="ssDNA-binding protein",
 |      ...                 dbxrefs=["ASAP:13298", "GI:16131885", "GeneID:948570"])
 |      &gt;&gt;&gt; print(repr(rec))
 |      SeqRecord(seq=Seq('MASRGVNKVILVGNLGQDPEVRYMPNGGAVANITLATSESWRDKATGEMKEQTE...IPF'), id='NP_418483.1', name='b4059', description='ssDNA-binding protein', dbxrefs=['ASAP:13298', 'GI:16131885', 'GeneID:948570'])
 |      
 |      At the python prompt you can also use this shorthand:
 |      
 |      &gt;&gt;&gt; rec
 |      SeqRecord(seq=Seq('MASRGVNKVILVGNLGQDPEVRYMPNGGAVANITLATSESWRDKATGEMKEQTE...IPF'), id='NP_418483.1', name='b4059', description='ssDNA-binding protein', dbxrefs=['ASAP:13298', 'GI:16131885', 'GeneID:948570'])
 |      
 |      Note that long sequences are shown truncated. Also note that any
 |      annotations, letter_annotations and features are not shown (as they
 |      would lead to a very long string).
 |  
 |  __str__(self) -&gt; str
 |      Return a human readable summary of the record and its annotation (string).
 |      
 |      The python built in function str works by calling the object's __str__
 |      method.  e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |      ...                    id="YP_025292.1", name="HokC",
 |      ...                    description="toxic membrane protein, small")
 |      &gt;&gt;&gt; print(str(record))
 |      ID: YP_025292.1
 |      Name: HokC
 |      Description: toxic membrane protein, small
 |      Number of features: 0
 |      Seq('MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF')
 |      
 |      In this example you don't actually need to call str explicitly, as the
 |      print command does this automatically:
 |      
 |      &gt;&gt;&gt; print(record)
 |      ID: YP_025292.1
 |      Name: HokC
 |      Description: toxic membrane protein, small
 |      Number of features: 0
 |      Seq('MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF')
 |      
 |      Note that long sequences are shown truncated.
 |  
 |  count(self, sub, start=None, end=None)
 |      Return the number of non-overlapping occurrences of sub in seq[start:end].
 |      
 |      Optional arguments start and end are interpreted as in slice notation.
 |      This method behaves as the count method of Python strings.
 |  
 |  format(self, format: str) -&gt; str
 |      Return the record as a string in the specified file format.
 |      
 |      The format should be a lower case string supported as an output
 |      format by Bio.SeqIO, which is used to turn the SeqRecord into a
 |      string.  e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF"),
 |      ...                    id="YP_025292.1", name="HokC",
 |      ...                    description="toxic membrane protein")
 |      &gt;&gt;&gt; record.format("fasta")
 |      '&gt;YP_025292.1 toxic membrane protein\nMKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF\n'
 |      &gt;&gt;&gt; print(record.format("fasta"))
 |      &gt;YP_025292.1 toxic membrane protein
 |      MKQHKAMIVALIVICITAVVAALVTRKDLCEVHIRTGQTEVAVF
 |      &lt;BLANKLINE&gt;
 |      
 |      The Python print function automatically appends a new line, meaning
 |      in this example a blank line is shown.  If you look at the string
 |      representation you can see there is a trailing new line (shown as
 |      slash n) which is important when writing to a file or if
 |      concatenating multiple sequence strings together.
 |      
 |      Note that this method will NOT work on every possible file format
 |      supported by Bio.SeqIO (e.g. some are for multiple sequences only,
 |      and binary formats are not supported).
 |  
 |  islower(self)
 |      Return True if all ASCII characters in the record's sequence are lowercase.
 |      
 |      If there are no cased characters, the method returns False.
 |  
 |  isupper(self)
 |      Return True if all ASCII characters in the record's sequence are uppercase.
 |      
 |      If there are no cased characters, the method returns False.
 |  
 |  lower(self) -&gt; 'SeqRecord'
 |      Return a copy of the record with a lower case sequence.
 |      
 |      All the annotation is preserved unchanged. e.g.
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Fasta/aster.pro", "fasta")
 |      &gt;&gt;&gt; print(record.format("fasta"))
 |      &gt;gi|3298468|dbj|BAA31520.1| SAMIPF
 |      GGHVNPAVTFGAFVGGNITLLRGIVYIIAQLLGSTVACLLLKFVTNDMAVGVFSLSAGVG
 |      VTNALVFEIVMTFGLVYTVYATAIDPKKGSLGTIAPIAIGFIVGANI
 |      &lt;BLANKLINE&gt;
 |      &gt;&gt;&gt; print(record.lower().format("fasta"))
 |      &gt;gi|3298468|dbj|BAA31520.1| SAMIPF
 |      gghvnpavtfgafvggnitllrgivyiiaqllgstvaclllkfvtndmavgvfslsagvg
 |      vtnalvfeivmtfglvytvyataidpkkgslgtiapiaigfivgani
 |      &lt;BLANKLINE&gt;
 |      
 |      To take a more annotation rich example,
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; old = SeqIO.read("EMBL/TRBG361.embl", "embl")
 |      &gt;&gt;&gt; len(old.features)
 |      3
 |      &gt;&gt;&gt; new = old.lower()
 |      &gt;&gt;&gt; len(old.features) == len(new.features)
 |      True
 |      &gt;&gt;&gt; old.annotations["organism"] == new.annotations["organism"]
 |      True
 |      &gt;&gt;&gt; old.dbxrefs == new.dbxrefs
 |      True
 |  
 |  reverse_complement(self, id: bool = False, name: bool = False, description: bool = False, features: bool = True, annotations: bool = False, letter_annotations: bool = True, dbxrefs: bool = False) -&gt; 'SeqRecord'
 |      Return new SeqRecord with reverse complement sequence.
 |      
 |      By default the new record does NOT preserve the sequence identifier,
 |      name, description, general annotation or database cross-references -
 |      these are unlikely to apply to the reversed sequence.
 |      
 |      You can specify the returned record's id, name and description as
 |      strings, or True to keep that of the parent, or False for a default.
 |      
 |      You can specify the returned record's features with a list of
 |      SeqFeature objects, or True to keep that of the parent, or False to
 |      omit them. The default is to keep the original features (with the
 |      strand and locations adjusted).
 |      
 |      You can also specify both the returned record's annotations and
 |      letter_annotations as dictionaries, True to keep that of the parent,
 |      or False to omit them. The default is to keep the original
 |      annotations (with the letter annotations reversed).
 |      
 |      To show what happens to the pre-letter annotations, consider an
 |      example Solexa variant FASTQ file with a single entry, which we'll
 |      read in as a SeqRecord:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      &gt;&gt;&gt; print(record.letter_annotations["solexa_quality"])
 |      [40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5]
 |      
 |      Now take the reverse complement, here we explicitly give a new
 |      identifier (the old identifier with a suffix):
 |      
 |      &gt;&gt;&gt; rc_record = record.reverse_complement(id=record.id + "_rc")
 |      &gt;&gt;&gt; print("%s %s" % (rc_record.id, rc_record.seq))
 |      slxa_0001_1_0001_01_rc NNNNNNACGTACGTACGTACGTACGTACGTACGTACGTACGTACGT
 |      
 |      Notice that the per-letter-annotations have also been reversed,
 |      although this may not be appropriate for all cases.
 |      
 |      &gt;&gt;&gt; print(rc_record.letter_annotations["solexa_quality"])
 |      [-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40]
 |      
 |      Now for the features, we need a different example. Parsing a GenBank
 |      file is probably the easiest way to get an nice example with features
 |      in it...
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; with open("GenBank/pBAD30.gb") as handle:
 |      ...     plasmid = SeqIO.read(handle, "gb")
 |      &gt;&gt;&gt; print("%s %i" % (plasmid.id, len(plasmid)))
 |      pBAD30 4923
 |      &gt;&gt;&gt; plasmid.seq
 |      Seq('GCTAGCGGAGTGTATACTGGCTTACTATGTTGGCACTGATGAGGGTGTCAGTGA...ATG')
 |      &gt;&gt;&gt; len(plasmid.features)
 |      13
 |      
 |      Now, let's take the reverse complement of this whole plasmid:
 |      
 |      &gt;&gt;&gt; rc_plasmid = plasmid.reverse_complement(id=plasmid.id+"_rc")
 |      &gt;&gt;&gt; print("%s %i" % (rc_plasmid.id, len(rc_plasmid)))
 |      pBAD30_rc 4923
 |      &gt;&gt;&gt; rc_plasmid.seq
 |      Seq('CATGGGCAAATATTATACGCAAGGCGACAAGGTGCTGATGCCGCTGGCGATTCA...AGC')
 |      &gt;&gt;&gt; len(rc_plasmid.features)
 |      13
 |      
 |      Let's compare the first CDS feature - it has gone from being the
 |      second feature (index 1) to the second last feature (index -2), its
 |      strand has changed, and the location switched round.
 |      
 |      &gt;&gt;&gt; print(plasmid.features[1])
 |      type: CDS
 |      location: [1081:1960](-)
 |      qualifiers:
 |          Key: label, Value: ['araC']
 |          Key: note, Value: ['araC regulator of the arabinose BAD promoter']
 |          Key: vntifkey, Value: ['4']
 |      &lt;BLANKLINE&gt;
 |      &gt;&gt;&gt; print(rc_plasmid.features[-2])
 |      type: CDS
 |      location: [2963:3842](+)
 |      qualifiers:
 |          Key: label, Value: ['araC']
 |          Key: note, Value: ['araC regulator of the arabinose BAD promoter']
 |          Key: vntifkey, Value: ['4']
 |      &lt;BLANKLINE&gt;
 |      
 |      You can check this new location, based on the length of the plasmid:
 |      
 |      &gt;&gt;&gt; len(plasmid) - 1081
 |      3842
 |      &gt;&gt;&gt; len(plasmid) - 1960
 |      2963
 |      
 |      Note that if the SeqFeature annotation includes any strand specific
 |      information (e.g. base changes for a SNP), this information is not
 |      amended, and would need correction after the reverse complement.
 |      
 |      Note trying to reverse complement a protein SeqRecord raises an
 |      exception:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; protein_rec = SeqRecord(Seq("MAIVMGR"), id="Test",
 |      ...                         annotations={"molecule_type": "protein"})
 |      &gt;&gt;&gt; protein_rec.reverse_complement()
 |      Traceback (most recent call last):
 |         ...
 |      ValueError: Proteins do not have complements!
 |      
 |      If you have RNA without any U bases, it must be annotated as RNA
 |      otherwise it will be treated as DNA by default with A mapped to T:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; rna1 = SeqRecord(Seq("ACG"), id="Test")
 |      &gt;&gt;&gt; rna2 = SeqRecord(Seq("ACG"), id="Test", annotations={"molecule_type": "RNA"})
 |      &gt;&gt;&gt; print(rna1.reverse_complement(id="RC", description="unk").format("fasta"))
 |      &gt;RC unk
 |      CGT
 |      &lt;BLANKLINE&gt;
 |      &gt;&gt;&gt; print(rna2.reverse_complement(id="RC", description="RNA").format("fasta"))
 |      &gt;RC RNA
 |      CGU
 |      &lt;BLANKLINE&gt;
 |      
 |      Also note you can reverse complement a SeqRecord using a MutableSeq:
 |      
 |      &gt;&gt;&gt; from Bio.Seq import MutableSeq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; rec = SeqRecord(MutableSeq("ACGT"), id="Test")
 |      &gt;&gt;&gt; rec.seq[0] = "T"
 |      &gt;&gt;&gt; print("%s %s" % (rec.id, rec.seq))
 |      Test TCGT
 |      &gt;&gt;&gt; rc = rec.reverse_complement(id=True)
 |      &gt;&gt;&gt; print("%s %s" % (rc.id, rc.seq))
 |      Test ACGA
 |  
 |  translate(self, table: str = 'Standard', stop_symbol: str = '*', to_stop: bool = False, cds: bool = False, gap: Optional[str] = None, id: bool = False, name: bool = False, description: bool = False, features: bool = False, annotations: bool = False, letter_annotations: bool = False, dbxrefs: bool = False) -&gt; 'SeqRecord'
 |      Return new SeqRecord with translated sequence.
 |      
 |      This calls the record's .seq.translate() method (which describes
 |      the translation related arguments, like table for the genetic code),
 |      
 |      By default the new record does NOT preserve the sequence identifier,
 |      name, description, general annotation or database cross-references -
 |      these are unlikely to apply to the translated sequence.
 |      
 |      You can specify the returned record's id, name and description as
 |      strings, or True to keep that of the parent, or False for a default.
 |      
 |      You can specify the returned record's features with a list of
 |      SeqFeature objects, or False (default) to omit them.
 |      
 |      You can also specify both the returned record's annotations and
 |      letter_annotations as dictionaries, True to keep that of the parent
 |      (annotations only), or False (default) to omit them.
 |      
 |      e.g. Loading a FASTA gene and translating it,
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; gene_record = SeqIO.read("Fasta/sweetpea.nu", "fasta")
 |      &gt;&gt;&gt; print(gene_record.format("fasta"))
 |      &gt;gi|3176602|gb|U78617.1|LOU78617 Lathyrus odoratus phytochrome A (PHYA) gene, partial cds
 |      CAGGCTGCGCGGTTTCTATTTATGAAGAACAAGGTCCGTATGATAGTTGATTGTCATGCA
 |      AAACATGTGAAGGTTCTTCAAGACGAAAAACTCCCATTTGATTTGACTCTGTGCGGTTCG
 |      ACCTTAAGAGCTCCACATAGTTGCCATTTGCAGTACATGGCTAACATGGATTCAATTGCT
 |      TCATTGGTTATGGCAGTGGTCGTCAATGACAGCGATGAAGATGGAGATAGCCGTGACGCA
 |      GTTCTACCACAAAAGAAAAAGAGACTTTGGGGTTTGGTAGTTTGTCATAACACTACTCCG
 |      AGGTTTGTT
 |      &lt;BLANKLINE&gt;
 |      
 |      And now translating the record, specifying the new ID and description:
 |      
 |      &gt;&gt;&gt; protein_record = gene_record.translate(table=11,
 |      ...                                        id="phya",
 |      ...                                        description="translation")
 |      &gt;&gt;&gt; print(protein_record.format("fasta"))
 |      &gt;phya translation
 |      QAARFLFMKNKVRMIVDCHAKHVKVLQDEKLPFDLTLCGSTLRAPHSCHLQYMANMDSIA
 |      SLVMAVVVNDSDEDGDSRDAVLPQKKKRLWGLVVCHNTTPRFV
 |      &lt;BLANKLINE&gt;
 |  
 |  upper(self) -&gt; 'SeqRecord'
 |      Return a copy of the record with an upper case sequence.
 |      
 |      All the annotation is preserved unchanged. e.g.
 |      
 |      &gt;&gt;&gt; from Bio.Seq import Seq
 |      &gt;&gt;&gt; from Bio.SeqRecord import SeqRecord
 |      &gt;&gt;&gt; record = SeqRecord(Seq("acgtACGT"), id="Test",
 |      ...                    description = "Made up for this example")
 |      &gt;&gt;&gt; record.letter_annotations["phred_quality"] = [1, 2, 3, 4, 5, 6, 7, 8]
 |      &gt;&gt;&gt; print(record.upper().format("fastq"))
 |      @Test Made up for this example
 |      ACGTACGT
 |      +
 |      "#$%&amp;'()
 |      &lt;BLANKLINE&gt;
 |      
 |      Naturally, there is a matching lower method:
 |      
 |      &gt;&gt;&gt; print(record.lower().format("fastq"))
 |      @Test Made up for this example
 |      acgtacgt
 |      +
 |      "#$%&amp;'()
 |      &lt;BLANKLINE&gt;
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |  
 |  __dict__
 |      dictionary for instance variables
 |  
 |  __weakref__
 |      list of weak references to the object
 |  
 |  letter_annotations
 |      Dictionary of per-letter-annotation for the sequence.
 |      
 |      For example, this can hold quality scores used in FASTQ or QUAL files.
 |      Consider this example using Bio.SeqIO to read in an example Solexa
 |      variant FASTQ file as a SeqRecord:
 |      
 |      &gt;&gt;&gt; from Bio import SeqIO
 |      &gt;&gt;&gt; record = SeqIO.read("Quality/solexa_faked.fastq", "fastq-solexa")
 |      &gt;&gt;&gt; print("%s %s" % (record.id, record.seq))
 |      slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
 |      &gt;&gt;&gt; print(list(record.letter_annotations))
 |      ['solexa_quality']
 |      &gt;&gt;&gt; print(record.letter_annotations["solexa_quality"])
 |      [40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5]
 |      
 |      The letter_annotations get sliced automatically if you slice the
 |      parent SeqRecord, for example taking the last ten bases:
 |      
 |      &gt;&gt;&gt; sub_record = record[-10:]
 |      &gt;&gt;&gt; print("%s %s" % (sub_record.id, sub_record.seq))
 |      slxa_0001_1_0001_01 ACGTNNNNNN
 |      &gt;&gt;&gt; print(sub_record.letter_annotations["solexa_quality"])
 |      [4, 3, 2, 1, 0, -1, -2, -3, -4, -5]
 |      
 |      Any python sequence (i.e. list, tuple or string) can be recorded in
 |      the SeqRecord's letter_annotations dictionary as long as the length
 |      matches that of the SeqRecord's sequence.  e.g.
 |      
 |      &gt;&gt;&gt; len(sub_record.letter_annotations)
 |      1
 |      &gt;&gt;&gt; sub_record.letter_annotations["dummy"] = "abcdefghij"
 |      &gt;&gt;&gt; len(sub_record.letter_annotations)
 |      2
 |      
 |      You can delete entries from the letter_annotations dictionary as usual:
 |      
 |      &gt;&gt;&gt; del sub_record.letter_annotations["solexa_quality"]
 |      &gt;&gt;&gt; sub_record.letter_annotations
 |      {'dummy': 'abcdefghij'}
 |      
 |      You can completely clear the dictionary easily as follows:
 |      
 |      &gt;&gt;&gt; sub_record.letter_annotations = {}
 |      &gt;&gt;&gt; sub_record.letter_annotations
 |      {}
 |      
 |      Note that if replacing the record's sequence with a sequence of a
 |      different length you must first clear the letter_annotations dict.
 |  
 |  seq
 |      The sequence itself, as a Seq or MutableSeq object.
 |  
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |  
 |  __annotations__ = {'annotations': typing.Dict[str, typing.Union[str, i...
 |  
 |  __hash__ = None
</code></pre>
</div>
</div>
<div id="cell-30" class="cell" data-executioninfo="{&quot;elapsed&quot;:969,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002836915,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="2fa59a4d-6ed7-4d7e-8d14-adf9c8251ddb" data-execution_count="7">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.<span class="bu">id</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.name)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.description)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.seq)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MW015936.1
MW015936
Zika virus isolate Zika virus/H.sapiens-tc/THA/2006/CVD_06-020, complete genome
AGTTGTTGATCTGTGTGAATCAGACTGCGACAGTTCGAGTTTGAAGCGAAAGCTAGCAACAGTATCAACAGGTTTTATTTTGGATTTGGAAACGAGAGTTTCTGGTCATGAAAAACCCAAAGAAGAAATCCGGAGGATTCCGGATTGTCAATATGCTAAAACGCGGAGTAGCCCGTGTGAGCCCCTTTGGGGGCTTGAAGAGGCTGCCAGCCGGACTTCTGCTGGGTCATGGGCCCATCAGGATGGTCTTGGCGATTCTAGCCTTTTTGAGATTCACGGCAATCAAGCCATCACTGGGTCTCATCAATAGATGGGGTTCAGTGGGGAAAAAAGAGGCTATGGAAATAATAAAGAAGTTCAAGAAAGATCTGGCTGCCATGCTGAGAATAATCAATGCTAGGAAGGAGAAGAAGAGACGAGGCACAGATACTAGTGTCGGAATTGTTGGCCTCCTGCTGACCACAGCCATGGCAGTGGAGGTCACTAGACGTGGGAGTGCATACTATATGTACTTGGACAGAAGTGATGCTGGGGAGGCCATATCTTTTCCAACCACACTGGGGATGAATAAGTGTTATATACAGATCATGGATCTTGGACACATGTGTGATGCCACCATGAGCTATGAATGCCCTATGCTGGATGAGGGGGTAGAACCAGATGACGTCGATTGTTGGTGCAACACGACGTCAACTTGGGTTGTGTACGGAACCTGCCACCACAAAAAAGGTGAAGCACGGAGATCTAGAAGAGCTGTGACGCTCCCCTCCCATTCCACTAGGAAGCTGCAAACGCGGTCGCAGACCTGGTTGGAATCAAGAGAATACACAAAGCACTTGATTAGAGTCGAAAATTGGATATTCAGGAACCCTGGCTTCGCGTTAGCAGCAGCTGCCATCGCTTGGCTTTTGGGAAGCTCAACGAGCCAAAAAGTCATATACTTGGTCATGATACTGCTGATTGCCCCGGCATACAGCATCAGGTGCATAGGAGTCAGCAATAGGGACTTTGTGGAAGGTATGTCAGGTGGGACTTGGGTTGATGTTGTCTTGGAACATGGAGGTTGTGTTACCGTAATGGCACAGGACAAACCGACTGTCGACATAGAGCTGGTTACAACAACAGTCAGCAACATGGCGGAGGTAAGATCCTACTGCTATGAGGCATCAATATCGGACATGGCTTCGGACAGCCGCTGCCCAACACAAGGTGAAGCCTACCTTGACAAGCAATCAGACACTCAATATGTCTGCAAAAGAACGTTAGTGGACAGAGGCTGGGGAAATGGATGTGGACTTTTTGGCAAAGGGAGCCTGGTGACATGCGCTAAGTTTGCATGCTCTAAGAAAATGACCGGGAAGAGCATCCAGCCAGAGAATCTGGAGTACCGGATAATGCTGTCAGTTCATGGCTCCCAGCACAGTGGGATGATCGTTAATGACACAGGACATGAAACTGATGAGAATAGAGCGAAGGTTGAGATAACGCCCAATTCACCAAGAGCCGAAGCCACCCTGGGGGGTTTTGGAAGCCTAGGACTTGATTGTGAACCGAGGACAGGCCTTGACTTTTCAGACTTGTATTACTTGACTATGAATAACAAGCACTGGTTGGTTCACAAGGAGTGGTTCCACGACATTCCATTACCTTGGCATGCTGGGGCAGACACCGGAACTCCACACTGGAACAACAAAGAAGCACTGGTAGAGTTCAAGGACGCACATGCCAAAAGGCAAACTGCCGTGGTTCTAGGGAGTCAAGAAGGAGCAGTTCACACGGCCCTTGCTGGAGCTCTGGAGGCTGAGATGGATGGTGCAAAGGGAAGGCTGTCCTCTGGCCACTTGAAATGTCGCCTGAAAATGGATAAACTTAGATTGAAGGGCGTGTCATACTCCTTGTGTACCGCATCGTTCACATTCACTAAGATCCCGGCTGAAACACTGCACGGGACAGTCACAGTGGAGGTACAGTACGCAGGGACAGATGGACCTTGCAAGGTTCCAGCTCAGATGGCGGTGGACATGCAAACTCTGACCCCAGTTGGGAGGTTGATAACCGCTAACCCTGTAATCACTGAAAGCACTGAGAACTCTAAGATGATGCTGGAACTTGATCCACCATTTGGGGACTCTTACATTGTCATAGGAGTCGGGGAGAAGAAGATCACCCACCACTGGCACAGGAGTGGCAGCACCATTGGAAAAGCATTTGAAGCCACTGTGAGAGGTGCCAAGAGAATGGCAGTCTTGGGAGACACAGCCTGGGACTTTGGATCAGTTGGAGGTGCTCTCAACTCACTGGGCAAGGGCATCCATCAAATTTTTGGAGCAGCTTTCAAATCATTGTTTGGAGGAATGTCCTGGTTCTCACAAATTCTCATTGGAACGTTGCTGGTGTGGTTGGGTCTGAATACAAAGAATGGATCTATTTCCCTTATGTGCTTGGCCTTAGGGGGAGTGTTGATCTTCTTATCCACAGCCGTCTCTGCTGATGTGGGGTGCTCGGTGGACTTCTCAAAGAAGGAAACGAGATGCGGTACAGGGGTGTTCGTCTATAACGACGTTGAAGCCTGGAGGGACAGGTACAAGTACCATCCTGACTCCCCTCGTAGATTGGCAGCAGCAGTCAAGCAAGCCTGGGAAGATGGGATCTGTGGGATCTCCTCTGTTTCAAGAATGGAAAACATCATGTGGAGATCAGTAGAAGGGGAGCTCAACGCAATCCTGGAAGAGAATGGAGTTCAACTGACGGTCGTTGTGGGATCTGTAAAAAACCCCATGTGGAGAGGTCCACAGAGATTGCCCGTGCCTGTGAACGAGCTGCCCCACGGCTGGAAGGCTTGGGGGAAATCGTACTTCGTCAGAGCAGCAAAGACAAATAACAGCTTTGTCGTGGATGGTGACACACTGAAGGAATGCCCACTCAAACATAGAGCATGGAACAGCTTTCTTGTGGAGGATCATGGGTTCGGGGTATTTCACACTAGTGTCTGGCTCAAGGTTAGAGAAGATTATTCATTAGAGTGTGATCCAGCCGTCATTGGAACAGCCGCTAAGGGAAAGGAGGCTGTGCACAGTGATCTAGGCTACTGGATTGAGAGTGAGAAGAACGACACATGGAGGCTGAAGAGGGCCCACCTGATCGAGATAAAAACATGTGAATGGCCGAAGTCCCACACATTGTGGACAGATGGAATAGAAGAAAGTGATCTGATCATACCCAAGTCTTTAGCTGGGCCACTCAGCCATCACAACACCAGAGAGGGCTACAGGACCCAAATGAAAGGGCCATGGCACAGTGAAGAGCTTGAAATTCGGTTTGAGGAATGCCCAGGCACTAAGGTCCACGTGGAGGAAACATGTGGAACAAGAGGACCATCTCTGAGATCAACCACTGCAAGCGGAAGGGTGATCGAGGAATGGTGCTGCAGGGAGTGCACAATGCCCCCACTGTCGTTCCGGGCTAAAGATGGTTGTTGGTATGGAATGGAGATAAGGCCCAGGAAAGAACCAGAAAGTAACTTAGTAAGGTCAATGGTGACTGCAGGATCAACTGATCACATGGATCACTTCTCCCTTGGAGTGCTTGTGATTCTGCTCATGGTGCAGGAAGGGCTGAAGAAGAGAATGACCACAAAGATCATCATAAGCACATCAATGGCAGTGCTGGTAGCTATGATCCTGGGAGGATTTTCAATGAGTGACCTGGCTAAGCTTGCAATTTTGATGGGTGCCACCTTCGCGGAAATGAACACTGGAGGAGATGTAGCTCATCTGGCGCTGATAGCGGCATTCAAAGTCAGACCTGCGTTGCTGGTATCTTTCATCTTCAGAGCTAATTGGACACCCCGTGAGAGCATGCTGCTGGCCTTGGCCTCGTGTCTTCTGCAAACTGCGATCTCCGCCTTGGAAGGCGACCTGATGGTTCTCATCAATGGTTTTGCTTTGGCCTGGTTGGCAATACGAGCGATGGTTGTTCCACGCACTGACAACATCACCTTGGCAATCCTGGCTGCTCTGACACCACTGGCCCGGGGCACACTGCTTGTGGCGTGGAGAGCAGGCCTTGCTACTTGCGGGGGGTTCATGCTCCTCTCTCTGAAGGGGAGAGGCAGTGTGAAGAAGAACTTACCATTTGTCATGGCCCTGGGACTAACCGCTGTGAGGCTGGTCGACCCCATCAACGTGGTGGGACTGCTGTTGCTCACAAGGAGTGGGAAGCGGAGCTGGCCCCCTAGTGAAGTACTCACAGCTGTTGGCCTGATATGCGCATTGGCTGGAGGGTTCGCCAAGGCGGATATAGAGATGGCTGGGCCCATAGCCGCGGTCGGTCTGCTAATTGTCAGTTACGTGGTCTCAGGAAAGAGTGTGGACATGTACATTGAAAGAGCAGGTGACATCACATGGGAAAAAGATGCGGAAGTCACTGGAAACAGTCCCCGGCTCGATGTGGCACTAGATGAGAGTGGTGATTTCTCCCTAGTGGAGGATGATGGTCCCCCCATGAGAGAGATCATACTCAAAGTGGTCCTGATGGCCATCTGTGGCATGAACCCAATAGCCATACCCTTTGCAGCTGGAGCGTGGTACGTGTATGTGAAGACTGGAAAAAGGAGTGGTGCTCTATGGGATGTGCCTGCTCCCAAGGAAGTAAAAAAGGGGGAGACCACAGATGGAGTGTACAGAGTAATGACTCGCAGACTGCTAGGTTCAACACAAGTTGGAGTGGGAGTCATGCAAGAGGGGGTCTTCCACACTATGTGGCACGTCACAAAAGGATCCGCGCTGAGAAGCGGTGAAGGGAGACTTGATCCATACTGGGGAGATGTCAAGCAGGATCTGGTGTCATACTGTGGTCCATGGAAGCTAGATGCCGCCTGGGACGGGCACAGCGAGGTGCAGCTCTTGGCCGTGCCCCCCGGAGAGAGAGCGAGGAACATCCAGACTCTGCCCGGAATATTTAAGACAAAGGATGGGGACATTGGAGCAGTTGCGCTGGACTACCCAGCAGGAACTTCAGGATCTCCAATCCTAGATAAGTGTGGGAGAGTGATAGGACTCTATGGTAATGGGGTCGTGATCAAAAATGGGAGTTATGTTAGTGCCATCACCCAAGGGAGGAGGGAGGAAGAGACTCCTGTTGAGTGCTTCGAGCCTTCGATGCTGAAGAAGAAGCAGCTAACTGTCTTAGACTTGCATCCTGGAGCTGGGAAAACCAGGAGAGTTCTTCCCGAAATAGTCCGTGAAGCCATAAAAACAAGACTCCGTACTGTGATCTTAGCTCCAACCAGGGTTGTCGCTGCTGAAATGGAGGAAGCCCTTAGAGGGCTTCCAGTGCGTTATATGACAACAGCAGTCAATGTCACCCATTCTGGGACAGAAATCGTTGACTTAATGTGCCATGCCACCTTCACTTCACGTCTACTACAGCCAATCAGAGTCCCCAACTATAATCTGTATATTATGGATGAGGCCCACTTCACAGATCCCTCAAGTATAGCAGCAAGAGGATACATTTCAACAAGGGTTGAGATGGGCGAGGCGGCTGCCATCTTCATGACTGCCACGCCACCAGGAACCCGTGACGCATTCCCGGACTCCAACTCACCAATTATGGACACCGAAGTGGAAGTCCCAGAGAGAGCCTGGAGCTCAGGCTTTGATTGGGTGACGGATCATTCTGGAAAAACAGTTTGGTTTGTTCCAAGCGTGAGGAACGGCAATGAGATCGCAGCTTGTCTGACAAAGGCTGGAAAACGGGTCATACAGCTCAGCAGAAAGACTTTTGAGACAGAGTTCCAGAAAACAAAACATCAAGAGTGGGACTTCGTCGTGACAACTGACATTTCAGAGATGGGCGCCAACTTTAAAGCTGACCGTGTCATAGATTCCAGGAGATGCCTAAAGCCGGTCATACTTGATGGCGAGAGAGTCATTCTGGCTGGACCCATGCCTGTCACACATGCCAGCGCTGCCCAGAGGAGGGGGCGCATAGGCAGGAATCCCAACAAACCTGGAGATGAGTATCTGTATGGAGGTGGGTGCGCAGAGACTGATGAAGACCATGCACACTGGCTTGAAGCAAGAATGCTTCTTGACAACATTTACCTCCAAGATGGCCTCATAGCCTCGCTCTATCGACCTGAGGCCGACAAAGTAGCAGCTATTGAGGGAGAGTTCAAGCTTAGGACGGAGCAAAGGAAGACCTTTGTGGAACTCATGAAAAGAGGAGATCTTCCTGTTTGGCTGGCCTATCAGGTTGCATCTGCCGGAATAACCTACACAGATAGAAGATGGTGCTTTGATGGCACGACCAACAACACCATAATGGAAGACAGTGTGCCGGCAGAGGTGTGGACCAGATACGGAGAGAAAAGAGTGCTCAAACCGAGGTGGATGGACGCCAGAGTTTGTTCAGATCATGCGGCCCTGAAGTCATTCAAAGAGTTTGCCGCTGGGAAAAGAGGAGCGGCCTTTGGAGTGATGGAAGCCCTGGGAACACTGCCAGGACACATGACAGAGAGATTCCAGGAGGCCATTGACAACCTCGCTGTGCTCATGCGGGCAGAGACTGGAAGCAGGCCCTACAAAGCCGCGGCGGCCCAATTGCCGGAGACCCTAGAGACCATCATGCTTTTGGGGTTGCTGGGAACAGTCTCGCTGGGAATCTTTTTCGTCTTGATGCGGAACAAGGGCATAGGGAAGATGGGCTTTGGAATGGTGACTCTTGGGGCCAGCGCATGGCTTATGTGGCTCTCGGAAATTGAGCCAGCCAGAATTGCATGTGTCCTCATTGTTGTGTTCCTATTGCTGGTGGTGCTCATACCTGAGCCAGAAAAGCAAAGATCTCCCCAGGACAACCAAATGGCAATCATCATCATGGTAGCAGTGGGTCTTCTGGGCTTGATTACCGCCAATGAACTCGGATGGTTGGAGAGAACAAAGAGTGACCTAAGCCATCTAATGGGAAGGAGAGAGGAGGGGGCAACCATAGGATTCTCAATGGACATTGACCTGCGGCCAGCCTCAGCTTGGGCTATCTATGCTGCTCTGACAACTTTCATTACCCCAGCCGTCCAACATGCAGTGACCACTTCATACAACAACTACTCCTTAATGGCGATGGCCACGCAAGCTGGAGTGTTGTTTGGTATGGGTAAAGGGATGCCATTCTACGCATGGGACTTTGGAGTCCCGCTGCTAATGATAGGTTGCTACTCACAATTAACACCCCTGACCCTAATAGTGGCCATCATTTTGCTCGTGGCGCACTACATGTACTTGATCCCAGGGCTGCAGGCAGCAGCTGCGCGTGCTGCTCAGAAGAGAACGGCAGCTGGCATCATGAAGAACCCTGTTGTGGATGGAATAGTGGTGACTGACATTGACACAATGACAATTGACCCCCAAGTGGAGAAAAAGATGGGACAGGTGCTACTCATAGCAGTAGCCGTCTCCAGCGCCATACTGTCGCGGACCGCCTGGGGGTGGGGGGAGGCTGGGGCCCTGATCACAGCTGCAACTTCCACTTTGTGGGAAGGCTCTCCGAACAAGTACTGGAACTCCTCCACAGCCACTTCACTGTGTAACATTTTTAGGGGAAGTTACTTGGCTGGAGCTTCTCTAATCTACACAGTAACAAGAAACGCTGGCTTGGTCAAGAGACGTGGGGGTGGAACGGGAGAGACCCTGGGAGAGAAGTGGAAGGCCCGCCTGAACCAGATGTCGGCCCTGGAGTTCTACTCCTACAAAAAGTCAGGCATCACCGAGGTGTGCAGAGAAGAGGCCCGCCGCGCCCTCAAGGACGGTGTGGCAACGGGAGGCCATGCTGTGTCCCGAGGAAGTGCAAAGCTGAGATGGTTGGTGGAGAGGGGATACCTGCAGCCCTATGGAAAGGTCATTGATCTTGGATGTGGCAGAGGGGGCTGGAGTTACTACGCCGCCACCATCCGCAAAGTTCAAGAAGTGAAAGGATACACAAAAGGAGGCCCTGGTCATGAGGAACCCATGTTGGTGCAAAGCTATGGGTGGAACATAGTCCGTCTTAAGAGTGGGGTGGACGTCTTTCATATGGCGGCTGAGCCGTGTGACACGTTGCTGTGTGATATAGGTGAGTCATCATCTAGTCCTGAAGTGGAAGAAGCACGGACGCTCAGAGTCCTCTCCATGGTGGGGGATTGGCTTGAAAAAAGACCAGGAGCCTTTTGTATAAAAGTGTTGTGCCCATACACCAGCACTATGATGGAAACCCTGGAGCGACTGCAGCGTAGGTATGGGGGAGGACTGGTCAGAGTGCCACTCTCCCGCAACTCTACACATGAGATGTACTGGGTCTCTGGAGCGAAAAGCAACACCATAAAAAGTGTGTCCACCACGAGCCAGCTCCTCTTGGGGCGCATGGACGGGCCCAGGAGGCCAGTGAAATATGAGGAGGATGTGAATCTCGGCTCTGGCACGCGGGCTGTGGTAAGCTGCGCTGAAGCTCCCAACATGAAGATCATTGGTAACCGCATTGAGAGGATCCGCAGTGAGCACGCGGAAACGTGGTTCTTTGACGAGAACCACCCATATAGGACATGGGCTTACCATGGAAGCTACGAGGCCCCCACACAAGGGTCAGCGTCCTCTCTAATAAACGGGGTTGTCAGGCTCCTGTCAAAACCCTGGGATGTGGTGACTGGAGTCACAGGAATAGCCATGACCGACACCACACCGTATGGTCAGCAAAGAGTTTTCAAGGAAAAAGTGGACACTAGGGTGCCAGACCCCCAAGAAGGCACTCGTCAGGTTATGAGCATGGTCTCTTCCTGGTTGTGGAAAGAGCTAGGCAAACACAAACGGCCACGAGTCTGTACCAAAGAAGAGTTCATCAACAAGGTTCGTAGCAATGCAGCATTAGGGGCAATATTTGAAGAGGAAAAAGAGTGGAAGACTGCAGTGGAAGCTGTGAACGATCCAAGGTTCTGGGCTCTAGTGGACAAGGAAAGAGAGCACCACCTGAGAGGAGAGTGCCAGAGCTGTGTGTACAACATGATGGGAAAAAGAGAAAAGAAACAAGGGGAATTTGGAAAGGCCAAGGGCAGCCGCGCCATCTGGTACATGTGGCTAGGGGCTAGATTTCTAGAGTTCGAAGCCCTTGGATTCTTGAACGAGGATCACTGGATGGGGAGAGAGAATTCACGAGGTGGTGTTGAAGGGCTGGGATTACAAAGACTCGGATATGTCTTAGAAGAGATGAGTCGCATACCAGGAGGAAGGATGTATGCAGATGACACTGCTGGCTGGGACACCCGCATCAGCAGGTTTGATCTGGAGAATGAAGCTCTAATCACCAACCAAATGGAGAAAGGGCACAGGGCCTTGGCATTGGCCATAATCAAGTACACATACCAAAACAAAGTGGTAAAGGTCCTTAGACCAGCTGAAAAAGGGAAGACAGTTATGGACATTATTTCAAGACAAGACCAAAGGGGGAGCGGACAAGTTGTCACTTACGCTCTTAATACATTTACCAACCTAGTGGTGCAGCTCATTCGGAATATGGAGGCTGAGGAAGTTCTAGAGATGCAAGACTTGTGGCTGCTGCGGAGGTCAGAGAAAGTGACCAACTGGTTGCAGAGCAATGGATGGGATAGGCTCAAACGAATGGCAGTCAGTGGAGATGATTGCGTTGTGAAACCAATTGATGATAGGTTTGCACATGCTCTCAGGTTCTTGAATGATATGGGAAAAGTTAGGAAGGACACACAAGAGTGGAAACCCTCAACTGGATGGGACAACTGGGAAGAAGTTCCGTTTTGCTCCCACCACTTCAATAAGCTCCATCTCAAGGACGGGAGGTCCATTGTGGTTCCCTGCCGCCACCAAGATGAACTGATTGGCCGAGCCCGCGTCTCACCAGGGGCGGGATGGAGCATCCGGGAGACTGCTTGCCTAGCAAAATCATATGCGCAAATGTGGCAGCTCCTTTATTTCCACAGAAGGGACCTCCGACTGATGGCCAATGCCATTTGTTCATCTGTGCCAGTTGACTGGGTTCCAACTGGGAGAACTACCTGGTCAATCCATGGAAAGGGAGAATGGATGACCACTGAAGACATGCTTGTGGTGTGGAACAGAGTGTGGATTGAGGAGAACGACCACATGGAAGACAAGACCCCAGTTACGAAATGGACAGACATTCCCTATTTGGGAAAAAGGGAAGACTTGTGGTGTGGGTCTCTCATAGGGCACAGACCGCGCACCACCTGGGCTGAGAACATTAAAAACACAGTCAACATGATGCGCAGGATCATAGGTGATGAAGAAAAGTACATGGACTACCTATCCACCCAAGTTCGCTACTTGGGTGAAGAAGGGTCCACACCTGGAGTGCTATAAGCACCAGTCTTAGTGTTGTCAGGCCTGCTAGTCAGCCACAGCTTGGGGAAAGCTGTGCAGCCTGTGACCCCCCCAGGAGAAGCTGGGAAACCAAGCCCATAGTCAGGCCGAGAACGCCATGGCACGGAAGAAGCCATGCTGCCTGTGAGCCCCTCAGAGGACACTGAGTCAAAAAACCCCACGCGCTTGGAGGCGCAGGATGGGAAAAGAAGGTGGCGACCTTCCCCACCCTTCAATCTGGGGCCTGAACTGGAGATCAGCTGTGGATCTCCAGAAGAGGGACTAGTGGTTAGAGGAGACCCCCCGGAAAACGCAAAACAGCATATTGACGCTGGGAAAGACCAGAGACTCCATGAGTTTCCACCACGCTGGCCGCCAGGCACAGATCGCCGAATAGCGGCGGCCGGTGTGGGGAAATCCATGGGTCT
[SeqFeature(SimpleLocation(ExactPosition(0), ExactPosition(10807), strand=1), type='source', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(10379), strand=1), type='gene', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(10379), strand=1), type='CDS', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(473), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(419), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(473), ExactPosition(977), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(473), ExactPosition(752), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(752), ExactPosition(977), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(977), ExactPosition(2489), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(2489), ExactPosition(3545), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(3545), ExactPosition(4223), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(4223), ExactPosition(4613), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(4613), ExactPosition(6464), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(6464), ExactPosition(6845), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(6845), ExactPosition(6914), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(6914), ExactPosition(7667), strand=1), type='mat_peptide', qualifiers=...), SeqFeature(SimpleLocation(ExactPosition(7667), ExactPosition(10376), strand=1), type='mat_peptide', qualifiers=...)]</code></pre>
</div>
</div>
<div id="cell-31" class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002846390,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="0bfe87fb-6616-4130-a76b-dbabc08b3a8e" data-execution_count="8">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(record.seq))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(record.features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10807</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>[SeqFeature(SimpleLocation(ExactPosition(0), ExactPosition(10807), strand=1), type='source', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(10379), strand=1), type='gene', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(10379), strand=1), type='CDS', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(473), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(107), ExactPosition(419), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(473), ExactPosition(977), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(473), ExactPosition(752), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(752), ExactPosition(977), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(977), ExactPosition(2489), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(2489), ExactPosition(3545), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(3545), ExactPosition(4223), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(4223), ExactPosition(4613), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(4613), ExactPosition(6464), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(6464), ExactPosition(6845), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(6845), ExactPosition(6914), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(6914), ExactPosition(7667), strand=1), type='mat_peptide', qualifiers=...),
 SeqFeature(SimpleLocation(ExactPosition(7667), ExactPosition(10376), strand=1), type='mat_peptide', qualifiers=...)]</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/zika-features.png" class="img-fluid figure-img"></p>
<figcaption>alt text</figcaption>
</figure>
</div>
<ul>
<li>Slicing</li>
</ul>
<div id="cell-34" class="cell" data-executioninfo="{&quot;elapsed&quot;:415,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002859102,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="a5adf5cd-7111-490c-cd6f-07ef0797961f" data-execution_count="9">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.features[<span class="dv">0</span>])</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.features[<span class="dv">1</span>])</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record.features[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>type: source
location: [0:10807](+)
qualifiers:
    Key: collection_date, Value: ['11-Aug-2006']
    Key: country, Value: ['Thailand']
    Key: db_xref, Value: ['taxon:64320']
    Key: host, Value: ['Homo sapiens']
    Key: isolate, Value: ['Zika virus/H.sapiens-tc/THA/2006/CVD_06-020']
    Key: isolation_source, Value: ['serum']
    Key: mol_type, Value: ['genomic RNA']
    Key: note, Value: ['Passage history:Toxorhynchites splendens mosquito (1 passage); Vero, African green monkey kidney cell (2 passages); Aedes albopictus C6/36 cell (1 passage); genotype: Asian']
    Key: organism, Value: ['Zika virus']

type: gene
location: [107:10379](+)
qualifiers:
    Key: gene, Value: ['POLY']

type: CDS
location: [107:10379](+)
qualifiers:
    Key: codon_start, Value: ['1']
    Key: gene, Value: ['POLY']
    Key: product, Value: ['polyprotein']
    Key: protein_id, Value: ['QOF88708.1']
    Key: translation, Value: ['MKNPKKKSGGFRIVNMLKRGVARVSPFGGLKRLPAGLLLGHGPIRMVLAILAFLRFTAIKPSLGLINRWGSVGKKEAMEIIKKFKKDLAAMLRIINARKEKKRRGTDTSVGIVGLLLTTAMAVEVTRRGSAYYMYLDRSDAGEAISFPTTLGMNKCYIQIMDLGHMCDATMSYECPMLDEGVEPDDVDCWCNTTSTWVVYGTCHHKKGEARRSRRAVTLPSHSTRKLQTRSQTWLESREYTKHLIRVENWIFRNPGFALAAAAIAWLLGSSTSQKVIYLVMILLIAPAYSIRCIGVSNRDFVEGMSGGTWVDVVLEHGGCVTVMAQDKPTVDIELVTTTVSNMAEVRSYCYEASISDMASDSRCPTQGEAYLDKQSDTQYVCKRTLVDRGWGNGCGLFGKGSLVTCAKFACSKKMTGKSIQPENLEYRIMLSVHGSQHSGMIVNDTGHETDENRAKVEITPNSPRAEATLGGFGSLGLDCEPRTGLDFSDLYYLTMNNKHWLVHKEWFHDIPLPWHAGADTGTPHWNNKEALVEFKDAHAKRQTAVVLGSQEGAVHTALAGALEAEMDGAKGRLSSGHLKCRLKMDKLRLKGVSYSLCTASFTFTKIPAETLHGTVTVEVQYAGTDGPCKVPAQMAVDMQTLTPVGRLITANPVITESTENSKMMLELDPPFGDSYIVIGVGEKKITHHWHRSGSTIGKAFEATVRGAKRMAVLGDTAWDFGSVGGALNSLGKGIHQIFGAAFKSLFGGMSWFSQILIGTLLVWLGLNTKNGSISLMCLALGGVLIFLSTAVSADVGCSVDFSKKETRCGTGVFVYNDVEAWRDRYKYHPDSPRRLAAAVKQAWEDGICGISSVSRMENIMWRSVEGELNAILEENGVQLTVVVGSVKNPMWRGPQRLPVPVNELPHGWKAWGKSYFVRAAKTNNSFVVDGDTLKECPLKHRAWNSFLVEDHGFGVFHTSVWLKVREDYSLECDPAVIGTAAKGKEAVHSDLGYWIESEKNDTWRLKRAHLIEIKTCEWPKSHTLWTDGIEESDLIIPKSLAGPLSHHNTREGYRTQMKGPWHSEELEIRFEECPGTKVHVEETCGTRGPSLRSTTASGRVIEEWCCRECTMPPLSFRAKDGCWYGMEIRPRKEPESNLVRSMVTAGSTDHMDHFSLGVLVILLMVQEGLKKRMTTKIIISTSMAVLVAMILGGFSMSDLAKLAILMGATFAEMNTGGDVAHLALIAAFKVRPALLVSFIFRANWTPRESMLLALASCLLQTAISALEGDLMVLINGFALAWLAIRAMVVPRTDNITLAILAALTPLARGTLLVAWRAGLATCGGFMLLSLKGRGSVKKNLPFVMALGLTAVRLVDPINVVGLLLLTRSGKRSWPPSEVLTAVGLICALAGGFAKADIEMAGPIAAVGLLIVSYVVSGKSVDMYIERAGDITWEKDAEVTGNSPRLDVALDESGDFSLVEDDGPPMREIILKVVLMAICGMNPIAIPFAAGAWYVYVKTGKRSGALWDVPAPKEVKKGETTDGVYRVMTRRLLGSTQVGVGVMQEGVFHTMWHVTKGSALRSGEGRLDPYWGDVKQDLVSYCGPWKLDAAWDGHSEVQLLAVPPGERARNIQTLPGIFKTKDGDIGAVALDYPAGTSGSPILDKCGRVIGLYGNGVVIKNGSYVSAITQGRREEETPVECFEPSMLKKKQLTVLDLHPGAGKTRRVLPEIVREAIKTRLRTVILAPTRVVAAEMEEALRGLPVRYMTTAVNVTHSGTEIVDLMCHATFTSRLLQPIRVPNYNLYIMDEAHFTDPSSIAARGYISTRVEMGEAAAIFMTATPPGTRDAFPDSNSPIMDTEVEVPERAWSSGFDWVTDHSGKTVWFVPSVRNGNEIAACLTKAGKRVIQLSRKTFETEFQKTKHQEWDFVVTTDISEMGANFKADRVIDSRRCLKPVILDGERVILAGPMPVTHASAAQRRGRIGRNPNKPGDEYLYGGGCAETDEDHAHWLEARMLLDNIYLQDGLIASLYRPEADKVAAIEGEFKLRTEQRKTFVELMKRGDLPVWLAYQVASAGITYTDRRWCFDGTTNNTIMEDSVPAEVWTRYGEKRVLKPRWMDARVCSDHAALKSFKEFAAGKRGAAFGVMEALGTLPGHMTERFQEAIDNLAVLMRAETGSRPYKAAAAQLPETLETIMLLGLLGTVSLGIFFVLMRNKGIGKMGFGMVTLGASAWLMWLSEIEPARIACVLIVVFLLLVVLIPEPEKQRSPQDNQMAIIIMVAVGLLGLITANELGWLERTKSDLSHLMGRREEGATIGFSMDIDLRPASAWAIYAALTTFITPAVQHAVTTSYNNYSLMAMATQAGVLFGMGKGMPFYAWDFGVPLLMIGCYSQLTPLTLIVAIILLVAHYMYLIPGLQAAAARAAQKRTAAGIMKNPVVDGIVVTDIDTMTIDPQVEKKMGQVLLIAVAVSSAILSRTAWGWGEAGALITAATSTLWEGSPNKYWNSSTATSLCNIFRGSYLAGASLIYTVTRNAGLVKRRGGGTGETLGEKWKARLNQMSALEFYSYKKSGITEVCREEARRALKDGVATGGHAVSRGSAKLRWLVERGYLQPYGKVIDLGCGRGGWSYYAATIRKVQEVKGYTKGGPGHEEPMLVQSYGWNIVRLKSGVDVFHMAAEPCDTLLCDIGESSSSPEVEEARTLRVLSMVGDWLEKRPGAFCIKVLCPYTSTMMETLERLQRRYGGGLVRVPLSRNSTHEMYWVSGAKSNTIKSVSTTSQLLLGRMDGPRRPVKYEEDVNLGSGTRAVVSCAEAPNMKIIGNRIERIRSEHAETWFFDENHPYRTWAYHGSYEAPTQGSASSLINGVVRLLSKPWDVVTGVTGIAMTDTTPYGQQRVFKEKVDTRVPDPQEGTRQVMSMVSSWLWKELGKHKRPRVCTKEEFINKVRSNAALGAIFEEEKEWKTAVEAVNDPRFWALVDKEREHHLRGECQSCVYNMMGKREKKQGEFGKAKGSRAIWYMWLGARFLEFEALGFLNEDHWMGRENSRGGVEGLGLQRLGYVLEEMSRIPGGRMYADDTAGWDTRISRFDLENEALITNQMEKGHRALALAIIKYTYQNKVVKVLRPAEKGKTVMDIISRQDQRGSGQVVTYALNTFTNLVVQLIRNMEAEEVLEMQDLWLLRRSEKVTNWLQSNGWDRLKRMAVSGDDCVVKPIDDRFAHALRFLNDMGKVRKDTQEWKPSTGWDNWEEVPFCSHHFNKLHLKDGRSIVVPCRHQDELIGRARVSPGAGWSIRETACLAKSYAQMWQLLYFHRRDLRLMANAICSSVPVDWVPTGRTTWSIHGKGEWMTTEDMLVVWNRVWIEENDHMEDKTPVTKWTDIPYLGKREDLWCGSLIGHRPRTTWAENIKNTVNMMRRIIGDEEKYMDYLSTQVRYLGEEGSTPGVL']
</code></pre>
</div>
</div>
<ul>
<li>extract sequence</li>
</ul>
<div id="cell-36" class="cell" data-outputid="e54f98f5-e956-4676-9637-c8d7f6f95ae9">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>record.features[<span class="dv">2</span>].extract(record.seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>Seq('ATGAAAAACCCAAAGAAGAAATCCGGAGGATTCCGGATTGTCAATATGCTAAAA...TAA')</code></pre>
</div>
</div>
<ul>
<li>위치 탐색 in 활용</li>
</ul>
<div id="cell-38" class="cell" data-outputid="9926c883-91e9-4f8c-bb88-381197965c3b">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> record.features:</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">4350</span> <span class="kw">in</span> feature:</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"type: </span><span class="sc">{</span>feature<span class="sc">.</span><span class="bu">type</span><span class="sc">}</span><span class="ss"> start: </span><span class="sc">{</span>feature<span class="sc">.</span>location<span class="sc">.</span>start<span class="sc">}</span><span class="ss"> end: </span><span class="sc">{</span>feature<span class="sc">.</span>location<span class="sc">.</span>end<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>type: source start: 0 end: 10807
type: gene start: 107 end: 10379
type: CDS start: 107 end: 10379
type: mat_peptide start: 4223 end: 4613</code></pre>
</div>
</div>
<ul>
<li>서열 위치로 직접 슬라이싱</li>
</ul>
<div id="cell-40" class="cell" data-outputid="329a7f24-64ef-42c1-da2f-169516a742a3">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sub_record <span class="op">=</span> record[<span class="dv">3000</span>:<span class="dv">5000</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sub_record)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(sub_record))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(sub_record.features))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sub_record.features[<span class="dv">0</span>])</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sub_record.features[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ID: MW015936.1
Name: MW015936
Description: Zika virus isolate Zika virus/H.sapiens-tc/THA/2006/CVD_06-020, complete genome
Number of features: 2
/molecule_type=RNA
Seq('TTAGAGAAGATTATTCATTAGAGTGTGATCCAGCCGTCATTGGAACAGCCGCTA...GAC')
2000
2
type: mat_peptide
location: [545:1223](+)
qualifiers:
    Key: gene, Value: ['POLY']
    Key: product, Value: ['nonstructural protein NS2A']

type: mat_peptide
location: [1223:1613](+)
qualifiers:
    Key: gene, Value: ['POLY']
    Key: product, Value: ['nonstructural protein NS2B']
</code></pre>
</div>
</div>
<section id="example---find-features-and-plot" class="level4" data-number="5.3.3.1">
<h4 data-number="5.3.3.1" class="anchored" data-anchor-id="example---find-features-and-plot"><span class="header-section-number">5.3.3.1</span> Example - find features and plot</h4>
<p>[User]</p>
<p><span style="color:blue; font-size: 20"> I have a genbank file. I want extract all the features of “mat_peptide” type in the file and calculate their length. can you show me a python code? </span></p>
<p>[ChatGPT]</p>
<p>Certainly! You can use Biopython to read a GenBank file and extract features of a specific type, such as “mat_peptide”. Here’s how you can do it:</p>
<p><strong>Python Script</strong></p>
<p>Here is the Python script that extracts all “mat_peptide” features from a GenBank file and calculates their lengths:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to extract mat_peptide features and calculate their lengths</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_mat_peptide_features(file_path):</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    record <span class="op">=</span> SeqIO.read(file_path, <span class="st">"genbank"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    mat_peptides <span class="op">=</span> []</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> feature <span class="kw">in</span> record.features:</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> feature.<span class="bu">type</span> <span class="op">==</span> <span class="st">"mat_peptide"</span>:</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>            start <span class="op">=</span> feature.location.start.position</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>            end <span class="op">=</span> feature.location.end.position</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>            length <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>            mat_peptides.append({</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"ID"</span>: feature.qualifiers.get(<span class="st">"product"</span>, [<span class="st">"Unknown"</span>])[<span class="dv">0</span>],</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Start"</span>: start,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"End"</span>: end,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Length"</span>: length</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat_peptides</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>genbank_file <span class="op">=</span> <span class="st">'example.gb'</span>  <span class="co"># Replace with your GenBank file path</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>mat_peptide_features <span class="op">=</span> extract_mat_peptide_features(genbank_file)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> peptide <span class="kw">in</span> mat_peptide_features:</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"ID: </span><span class="sc">{</span>peptide[<span class="st">'ID'</span>]<span class="sc">}</span><span class="ss">, Start: </span><span class="sc">{</span>peptide[<span class="st">'Start'</span>]<span class="sc">}</span><span class="ss">, End: </span><span class="sc">{</span>peptide[<span class="st">'End'</span>]<span class="sc">}</span><span class="ss">, Length: </span><span class="sc">{</span>peptide[<span class="st">'Length'</span>]<span class="sc">}</span><span class="ss"> bp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Explanation</strong></p>
<ol type="1">
<li><strong>Import Libraries</strong>: Import the necessary modules from Biopython.</li>
<li><strong>extract_mat_peptide_features Function</strong>: This function reads the GenBank file, extracts features of type “mat_peptide”, calculates their start and end positions, and determines their lengths.</li>
<li><strong>Example Usage</strong>: Replace <code>'example.gb'</code> with the path to your GenBank file. The script will read the file, extract the “mat_peptide” features, and print their IDs, start and end positions, and lengths.</li>
</ol>
<p><strong>Running the Script</strong></p>
<ol type="1">
<li><p>Save the script to a file, for example, <code>extract_mat_peptides.py</code>.</p></li>
<li><p>Ensure you have the GenBank file (e.g., <code>example.gb</code>) in the same directory.</p></li>
<li><p>Run the script from the command line:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> extract_mat_peptides.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
<p>This script will read the GenBank file, extract all “mat_peptide” features, calculate their lengths, and print the details. If you have any specific questions or need further assistance, feel free to ask!</p>
<ul>
<li>Find a specific feature</li>
</ul>
<div id="cell-45" class="cell" data-outputid="d6220ed3-0767-4b9b-923d-961d1842697a">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>records <span class="op">=</span> SeqIO.parse(<span class="st">"data/MW015936.gb"</span>, <span class="st">"genbank"</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> record.features:</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> feature.<span class="bu">type</span> <span class="op">==</span> <span class="st">"mat_peptide"</span>:</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(feature.qualifiers[<span class="st">"product"</span>])</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(feature.location.start, feature.location.end)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['anchored capsid protein C']
107 473
['capsid protein C']
107 419
['membrane glycoprotein precursor M']
473 977
['protein pr']
473 752
['membrane glycoprotein M']
752 977
['envelope protein E']
977 2489
['nonstructural protein NS1']
2489 3545
['nonstructural protein NS2A']
3545 4223
['nonstructural protein NS2B']
4223 4613
['nonstructural protein NS3']
4613 6464
['nonstructural protein NS4A']
6464 6845
['protein 2K']
6845 6914
['nonstructural protein NS4B']
6914 7667
['RNA-dependent RNA polymerase NS5']
7667 10376</code></pre>
</div>
</div>
<ul>
<li>get length and plot</li>
</ul>
<div id="cell-47" class="cell" data-outputid="7dee6192-0ded-496d-f055-2a73efb7413f">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>mat_peptides <span class="op">=</span> []</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>records <span class="op">=</span> SeqIO.parse(<span class="st">"data/MW015936.gb"</span>, <span class="st">"genbank"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> feature <span class="kw">in</span> record.features:</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> feature.<span class="bu">type</span> <span class="op">==</span> <span class="st">"mat_peptide"</span>:</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        mat_peptides.append({</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"id"</span>: feature.qualifiers[<span class="st">"product"</span>],</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"start"</span>: feature.location.start,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"end"</span>: feature.location.end,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"length"</span>: feature.location.end <span class="op">-</span> feature.location.start</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(mat_peptides)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co"># df["length"].hist()</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>sns.histplot(df[<span class="st">"length"</span>])</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation <span class="op">=</span> <span class="dv">90</span>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="cnu_bioinformatics_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="entrez" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="entrez"><span class="header-section-number">5.3.4</span> Entrez</h3>
<ul>
<li>Provides code to access NCBI over the WWW</li>
<li>파일 읽기/쓰기 with 문 사용</li>
</ul>
<div id="cell-49" class="cell" data-executioninfo="{&quot;elapsed&quot;:548,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002883866,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="634c4fcd-58d6-461a-aaed-2a88e403756b" data-execution_count="10">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>Entrez.email <span class="op">=</span> <span class="st">"kimhaseong@gmail.com"</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Searching NCBI Nucleotide database</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>handle <span class="op">=</span> Entrez.esearch(db<span class="op">=</span><span class="st">"nucleotide"</span>, term<span class="op">=</span><span class="st">"Homo sapiens[Organism] AND BRCA1[Gene]"</span>, retmax<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>record <span class="op">=</span> Entrez.read(handle)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record[<span class="st">"IdList"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['262359905', '2703623457', '2703623455', '2703623453', '2703623451']</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-executioninfo="{&quot;elapsed&quot;:1776,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718002926259,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="ac58c836-d2a6-4f99-a636-bd5b110d2364" data-execution_count="11">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>entid <span class="op">=</span> record[<span class="st">"IdList"</span>][<span class="dv">0</span>]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, rettype<span class="op">=</span><span class="st">"gb"</span>, retmode<span class="op">=</span><span class="st">"text"</span>, <span class="bu">id</span><span class="op">=</span>entid) <span class="im">as</span> handle:</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    seq_record <span class="op">=</span> SeqIO.read(handle, <span class="st">"gb"</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seq_record<span class="sc">.</span><span class="bu">id</span><span class="sc">}</span><span class="ss"> with </span><span class="sc">{</span><span class="bu">len</span>(seq_record.features)<span class="sc">}</span><span class="ss"> features"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(seq_record))</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>SeqIO.write(seq_record, <span class="st">"/content/drive/My Drive/2024-cnu-lecture/data/"</span><span class="op">+</span>seq_record.<span class="bu">id</span><span class="op">+</span><span class="st">".fa"</span>, <span class="st">"fasta"</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co">#SeqIO.write(seq_record, seq_record.id+".fa", "fasta")</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq_record)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NG_005905.2 with 130 features
&lt;class 'Bio.SeqRecord.SeqRecord'&gt;
ID: NG_005905.2
Name: NG_005905
Description: Homo sapiens BRCA1 DNA repair associated (BRCA1), RefSeqGene (LRG_292) on chromosome 17
Number of features: 130
/molecule_type=DNA
/topology=linear
/data_file_division=PRI
/date=09-JUN-2024
/accessions=['NG_005905']
/sequence_version=2
/keywords=['RefSeq', 'RefSeqGene']
/source=Homo sapiens (human)
/organism=Homo sapiens
/taxonomy=['Eukaryota', 'Metazoa', 'Chordata', 'Craniata', 'Vertebrata', 'Euteleostomi', 'Mammalia', 'Eutheria', 'Euarchontoglires', 'Primates', 'Haplorrhini', 'Catarrhini', 'Hominidae', 'Homo']
/references=[Reference(title='Emerging roles of BRCA1 alternative splicing', ...), Reference(title='Expression profiles of BRCA1 splice variants in asynchronous and in G1/S synchronized tumor cell lines', ...), Reference(title='BRCA1: a review of structure and putative functions', ...), Reference(title='Mutations and alternative splicing of the BRCA1 gene in UK breast/ovarian cancer families', ...), Reference(title='Differential subcellular localization, expression and biological toxicity of BRCA1 and the splice variant BRCA1-delta11b', ...), Reference(title='Localization of BRCA1 and a splice variant identifies the nuclear localization signal', ...), Reference(title='Characterization of functional messenger RNA splice variants of BRCA1 expressed in nonmalignant and tumor-derived breast cells', ...), Reference(title='Growth retardation and tumour inhibition by BRCA1', ...), Reference(title='Distinct transcription start sites generate two forms of BRCA1 mRNA', ...), Reference(title='A strong candidate for the breast and ovarian cancer susceptibility gene BRCA1', ...), Reference(title='Fanconi Anemia', ...), Reference(title='BRCA1- and BRCA2-Associated Hereditary Breast and Ovarian Cancer', ...)]
/comment=REVIEWED REFSEQ: This record has been curated by NCBI staff in
collaboration with Andrew Devereau, Nazneen Rahman. The reference
sequence was derived from AC109326.11, AC060780.18 and AC135721.4.
This sequence is a reference standard in the RefSeqGene project.
On Nov 4, 2009 this sequence version replaced NG_005905.1.
Summary: This gene encodes a 190 kD nuclear phosphoprotein that
plays a role in maintaining genomic stability, and it also acts as
a tumor suppressor. The BRCA1 gene contains 22 exons spanning about
110 kb of DNA. The encoded protein combines with other tumor
suppressors, DNA damage sensors, and signal transducers to form a
large multi-subunit protein complex known as the BRCA1-associated
genome surveillance complex (BASC). This gene product associates
with RNA polymerase II, and through the C-terminal domain, also
interacts with histone deacetylase complexes. This protein thus
plays a role in transcription, DNA repair of double-stranded
breaks, and recombination. Mutations in this gene are responsible
for approximately 40% of inherited breast cancers and more than 80%
of inherited breast and ovarian cancers. Alternative splicing plays
a role in modulating the subcellular localization and physiological
function of this gene. Many alternatively spliced transcript
variants, some of which are disease-associated mutations, have been
described for this gene, but the full-length natures of only some
of these variants has been described. A related pseudogene, which
is also located on chromosome 17, has been identified. [provided by
RefSeq, May 2020].
Seq('TGTGTGTATGAAGTTAACTTCAAAGCAAGCTTCCTGTGCTGAGGGGGTGGGAGG...GGC')</code></pre>
</div>
</div>
<ul>
<li>여러개 record에 대해서는 parse 함수를 사용</li>
</ul>
<div id="cell-52" class="cell" data-outputid="e9a002c5-254a-42d5-fb6c-d9e0949b6eb0">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>entids <span class="op">=</span> record[<span class="st">"IdList"</span>]</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, rettype<span class="op">=</span><span class="st">"gb"</span>, retmode<span class="op">=</span><span class="st">"text"</span>, <span class="bu">id</span><span class="op">=</span>entids) <span class="im">as</span> handle:</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq_record <span class="kw">in</span> SeqIO.parse(handle, <span class="st">"gb"</span>):</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seq_record<span class="sc">.</span><span class="bu">id</span><span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>seq_record<span class="sc">.</span>description[:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Sequence length </span><span class="sc">{</span><span class="bu">len</span>(seq_record)<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="bu">len</span>(seq_record.features)<span class="sc">}</span><span class="ss"> </span><span class="ch">\</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="ss">              features, from </span><span class="sc">{</span>seq_record<span class="sc">.</span>annotations[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        SeqIO.write(seq_record, <span class="st">"/content/drive/My Drive/2024-cnu-lecture/data/"</span><span class="op">+</span>seq_record.<span class="bu">id</span><span class="op">+</span><span class="st">".gb"</span>, <span class="st">"gb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NG_005905.2 Homo sapiens BRCA1 DNA repair associated (BRCA1), 
Sequence length 193689, 130               features, from Homo sapiens (human)


PP465840.1 Homo sapiens isolate TWH-3503-0-1 breast and ovari
Sequence length 5592, 3               features, from Homo sapiens (human)


PP465839.1 Homo sapiens isolate TWH-3747-0-1 truncated breast
Sequence length 891, 3               features, from Homo sapiens (human)


PP465838.1 Homo sapiens isolate TWH-3713-0-1 truncated breast
Sequence length 3462, 3               features, from Homo sapiens (human)


PP465837.1 Homo sapiens isolate OV-0673-0-1 truncated breast 
Sequence length 4167, 3               features, from Homo sapiens (human)

</code></pre>
</div>
</div>
</section>
<section id="pairwise-sequence-alignment" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="pairwise-sequence-alignment"><span class="header-section-number">5.3.5</span> Pairwise sequence alignment</h3>
<div id="cell-54" class="cell" data-executioninfo="{&quot;elapsed&quot;:579,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718003027343,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="64530e77-cb9d-43e3-acc2-3f4dd32fce7b" data-execution_count="12">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Align</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>aligner <span class="op">=</span> Align.PairwiseAligner()</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>aligner.mode <span class="op">=</span> <span class="st">"global"</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>aligner.mismatch_score <span class="op">=</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>alignments <span class="op">=</span> aligner.align(<span class="st">"AAACAAA"</span>, <span class="st">"ACGAAAGAAA"</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligner)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(alignments))</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments.score)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">0</span>])</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">1</span>])</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pairwise sequence aligner with parameters
  wildcard: None
  match_score: 1.000000
  mismatch_score: -10.000000
  target_internal_open_gap_score: 0.000000
  target_internal_extend_gap_score: 0.000000
  target_left_open_gap_score: 0.000000
  target_left_extend_gap_score: 0.000000
  target_right_open_gap_score: 0.000000
  target_right_extend_gap_score: 0.000000
  query_internal_open_gap_score: 0.000000
  query_internal_extend_gap_score: 0.000000
  query_left_open_gap_score: 0.000000
  query_left_extend_gap_score: 0.000000
  query_right_open_gap_score: 0.000000
  query_right_extend_gap_score: 0.000000
  mode: global

12
6.0
target            0 A--AACA-AA-  7
                  0 |--||-|-||- 11
query             0 ACGAA-AGAAA 10

target            0 A--AACA-A-A  7
                  0 |--||-|-|-| 11
query             0 ACGAA-AGAAA 10

target            0 A--AACA--AA  7
                  0 |--||-|--|| 11
query             0 ACGAA-AGAAA 10
</code></pre>
</div>
</div>
<div id="cell-55" class="cell" data-executioninfo="{&quot;elapsed&quot;:354,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718003039174,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="fb5ac001-c113-4902-d50b-ecaec31c994a" data-execution_count="13">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>aligner <span class="op">=</span> Align.PairwiseAligner(mismatch_score<span class="op">=-</span><span class="dv">10</span>, mode<span class="op">=</span><span class="st">"local"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>alignments <span class="op">=</span> aligner.align(<span class="st">"AAACAAA"</span>, <span class="st">"ACGAAAGAAA"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(alignments))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments.score)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">0</span>])</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">1</span>])</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>12
6.0
target            0 A--AACA-AA  7
                  0 |--||-|-|| 10
query             0 ACGAA-AGAA  9

target            0 A--AACA-A-A  7
                  0 |--||-|-|-| 11
query             0 ACGAA-AGAAA 10

target            0 A--AACA--AA  7
                  0 |--||-|--|| 11
query             0 ACGAA-AGAAA 10
</code></pre>
</div>
</div>
<section id="alignment-objects" class="level4" data-number="5.3.5.1">
<h4 data-number="5.3.5.1" class="anchored" data-anchor-id="alignment-objects"><span class="header-section-number">5.3.5.1</span> Alignment objects</h4>
<div id="cell-57" class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718003686363,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="aebd899c-2a65-492f-c9c6-d241d87866ed" data-execution_count="15">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">0</span>])</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(alignments[<span class="dv">0</span>]))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">0</span>].shape)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">0</span>].indices)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[<span class="dv">0</span>].counts())</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>display(alignments[<span class="dv">0</span>].frequencies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>target            0 A--AACA-AA  7
                  0 |--||-|-|| 10
query             0 ACGAA-AGAA  9

&lt;class 'Bio.Align.Alignment'&gt;
(2, 10)
[[ 0 -1 -1  1  2  3  4 -1  5  6]
 [ 0  1  2  3  4 -1  5  6  7  8]]
AlignmentCounts(gaps=4, identities=6, mismatches=0)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>{'A': array([2., 0., 0., 2., 2., 0., 2., 0., 2., 2.]),
 '-': array([0., 1., 1., 0., 0., 1., 0., 1., 0., 0.]),
 'C': array([0., 1., 0., 0., 0., 1., 0., 0., 0., 0.]),
 'G': array([0., 0., 1., 0., 0., 0., 0., 1., 0., 0.])}</code></pre>
</div>
</div>
</section>
<section id="user-biopython을-사용해서-ncbi에서-egfp-와-sfgfp-서열을-다운로드-받고-서열을-비교하는-코드를-알려줘" class="level4" data-number="5.3.5.2">
<h4 data-number="5.3.5.2" class="anchored" data-anchor-id="user-biopython을-사용해서-ncbi에서-egfp-와-sfgfp-서열을-다운로드-받고-서열을-비교하는-코드를-알려줘"><span class="header-section-number">5.3.5.2</span> [User] biopython을 사용해서 NCBI에서 egfp 와 sfgfp 서열을 다운로드 받고 서열을 비교하는 코드를 알려줘</h4>
</section>
<section id="chatgpt-1" class="level4" data-number="5.3.5.3">
<h4 data-number="5.3.5.3" class="anchored" data-anchor-id="chatgpt-1"><span class="header-section-number">5.3.5.3</span> [ChatGPT]</h4>
<div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez, SeqIO</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.SeqRecord <span class="im">import</span> SeqRecord</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> pairwise2</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.pairwise2 <span class="im">import</span> format_alignment</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Always provide your email when using NCBI's Entrez</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>Entrez.email <span class="op">=</span> <span class="st">"your.email@example.com"</span>  <span class="co"># Replace with your email address</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_sequence(accession):</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Download a sequence by its accession number from NCBI."""</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    handle <span class="op">=</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, <span class="bu">id</span><span class="op">=</span>accession, rettype<span class="op">=</span><span class="st">"gb"</span>, retmode<span class="op">=</span><span class="st">"text"</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>    seq_record <span class="op">=</span> SeqIO.read(handle, <span class="st">"genbank"</span>)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>    handle.close()</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq_record</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_sequences(seq1, seq2):</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform a simple sequence alignment between two sequences."""</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    alignments <span class="op">=</span> pairwise2.align.globalxx(seq1.seq, seq2.seq)</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> alignments[<span class="dv">0</span>]  <span class="co"># Return the first alignment</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Accession numbers for EGFP and sfGFP from NCBI</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>egfp_accession <span class="op">=</span> <span class="st">"U55762"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>sfgfp_accession <span class="op">=</span> <span class="st">"EU304438"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Download sequences</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>egfp_seq <span class="op">=</span> download_sequence(egfp_accession)</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>sfgfp_seq <span class="op">=</span> download_sequence(sfgfp_accession)</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare sequences</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>alignment <span class="op">=</span> compare_sequences(egfp_seq, sfgfp_seq)</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Print alignment</span></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(format_alignment(<span class="op">*</span>alignment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="user-출력을-좀-더-보기-좋게-해줘" class="level4" data-number="5.3.5.4">
<h4 data-number="5.3.5.4" class="anchored" data-anchor-id="user-출력을-좀-더-보기-좋게-해줘"><span class="header-section-number">5.3.5.4</span> [User] 출력을 좀 더 보기 좋게 해줘</h4>
</section>
<section id="chatgtp" class="level4" data-number="5.3.5.5">
<h4 data-number="5.3.5.5" class="anchored" data-anchor-id="chatgtp"><span class="header-section-number">5.3.5.5</span> [ChatGTP]</h4>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez, SeqIO</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> pairwise2</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.pairwise2 <span class="im">import</span> format_alignment</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Always provide your email when using NCBI's Entrez</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>Entrez.email <span class="op">=</span> <span class="st">"your.email@example.com"</span>  <span class="co"># Replace with your email address</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_sequence(accession):</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Download a sequence by its accession number from NCBI."""</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    handle <span class="op">=</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, <span class="bu">id</span><span class="op">=</span>accession, rettype<span class="op">=</span><span class="st">"gb"</span>, retmode<span class="op">=</span><span class="st">"text"</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    seq_record <span class="op">=</span> SeqIO.read(handle, <span class="st">"genbank"</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    handle.close()</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq_record</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_sequences(seq1, seq2):</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform a sequence alignment between two sequences and format the output."""</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Using a simple scoring: 1 point for match, -1 for mismatch, -2 for opening a gap, -0.5 for extending it</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    alignments <span class="op">=</span> pairwise2.align.globalms(seq1.seq, seq2.seq, <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="fl">0.5</span>, one_alignment_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    best_alignment <span class="op">=</span> alignments[<span class="dv">0</span>]</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_alignment</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_alignment(alignment):</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Print formatted alignment."""</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2, score, start, end <span class="op">=</span> alignment</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    match_line <span class="op">=</span> []  <span class="co"># To store the match symbols ('|', ' ', '*')</span></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(aligned_seq1, aligned_seq2):</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> base1 <span class="op">==</span> base2:</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>            match_line.append(<span class="st">'|'</span>)  <span class="co"># Match</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>            match_line.append(<span class="st">' '</span>)  <span class="co"># Mismatch</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the results</span></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Alignment:"</span>)</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Score:"</span>, score)</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(aligned_seq1[start:end])</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">''</span>.join(match_line[start:end]))</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(aligned_seq2[start:end])</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Accession numbers for EGFP and sfGFP</span></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>egfp_accession <span class="op">=</span> <span class="st">"U55762"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>sfgfp_accession <span class="op">=</span> <span class="st">"EU304438"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Download sequences</span></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>egfp_seq <span class="op">=</span> download_sequence(egfp_accession)</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>sfgfp_seq <span class="op">=</span> download_sequence(sfgfp_accession)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare sequences</span></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>alignment <span class="op">=</span> compare_sequences(egfp_seq, sfgfp_seq)</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Print formatted alignment</span></span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>print_alignment(alignment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="user-위-코드의-서열-비교-출력을-지정된-base-pair-길이만큼-끊어서-보여주는-코드를-만들어줘" class="level4" data-number="5.3.5.6">
<h4 data-number="5.3.5.6" class="anchored" data-anchor-id="user-위-코드의-서열-비교-출력을-지정된-base-pair-길이만큼-끊어서-보여주는-코드를-만들어줘"><span class="header-section-number">5.3.5.6</span> [User] 위 코드의 서열 비교 출력을 지정된 base pair 길이만큼 끊어서 보여주는 코드를 만들어줘</h4>
</section>
<section id="chatgpt-2" class="level4" data-number="5.3.5.7">
<h4 data-number="5.3.5.7" class="anchored" data-anchor-id="chatgpt-2"><span class="header-section-number">5.3.5.7</span> [ChatGPT]</h4>
<div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez, SeqIO</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> pairwise2</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.pairwise2 <span class="im">import</span> format_alignment</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Always provide your email when using NCBI's Entrez</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>Entrez.email <span class="op">=</span> <span class="st">"your.email@example.com"</span>  <span class="co"># Replace with your email address</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_sequence(accession):</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Download a sequence by its accession number from NCBI."""</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    handle <span class="op">=</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, <span class="bu">id</span><span class="op">=</span>accession, rettype<span class="op">=</span><span class="st">"gb"</span>, retmode<span class="op">=</span><span class="st">"text"</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    seq_record <span class="op">=</span> SeqIO.read(handle, <span class="st">"genbank"</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    handle.close()</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq_record</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_sequences(seq1, seq2):</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform a sequence alignment between two sequences and format the output."""</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    alignments <span class="op">=</span> pairwise2.align.globalms(seq1.seq, seq2.seq, <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="fl">0.5</span>, one_alignment_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> alignments[<span class="dv">0</span>]  <span class="co"># Return the first alignment</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_alignment(alignment, chunk_size<span class="op">=</span><span class="dv">60</span>):</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Print formatted alignment in chunks."""</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2, score, start, end <span class="op">=</span> alignment</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>    alignment_length <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Alignment Score:"</span>, score)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, alignment_length, chunk_size):</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>        subseq1 <span class="op">=</span> aligned_seq1[start<span class="op">+</span>i:start<span class="op">+</span>i<span class="op">+</span>chunk_size]</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>        subseq2 <span class="op">=</span> aligned_seq2[start<span class="op">+</span>i:start<span class="op">+</span>i<span class="op">+</span>chunk_size]</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate a matching line</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>        match_line <span class="op">=</span> <span class="st">''</span>.join(<span class="st">'|'</span> <span class="cf">if</span> b1 <span class="op">==</span> b2 <span class="cf">else</span> <span class="st">' '</span> <span class="cf">for</span> b1, b2 <span class="kw">in</span> <span class="bu">zip</span>(subseq1, subseq2))</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the alignment in chunks</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Alignment chunk from position"</span>, start<span class="op">+</span>i<span class="op">+</span><span class="dv">1</span>, <span class="st">"to"</span>, <span class="bu">min</span>(start<span class="op">+</span>i<span class="op">+</span>chunk_size, alignment_length))</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(subseq1)</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(match_line)</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(subseq2)</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Accession numbers for EGFP and sfGFP</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>egfp_accession <span class="op">=</span> <span class="st">"U55762"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>sfgfp_accession <span class="op">=</span> <span class="st">"EU304438"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Download sequences</span></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>egfp_seq <span class="op">=</span> download_sequence(egfp_accession)</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>sfgfp_seq <span class="op">=</span> download_sequence(sfgfp_accession)</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare sequences</span></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>alignment <span class="op">=</span> compare_sequences(egfp_seq, sfgfp_seq)</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Print formatted alignment</span></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>print_alignment(alignment, chunk_size<span class="op">=</span><span class="dv">60</span>)  <span class="co"># You can adjust the chunk size as needed</span></span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="user-출력-서열-앞쪽에-각-서열의-accession-number를-붙여주고-마지막에는-총-길이와-다른-서열의-개수-등-통계를-출력해줘" class="level4" data-number="5.3.5.8">
<h4 data-number="5.3.5.8" class="anchored" data-anchor-id="user-출력-서열-앞쪽에-각-서열의-accession-number를-붙여주고-마지막에는-총-길이와-다른-서열의-개수-등-통계를-출력해줘"><span class="header-section-number">5.3.5.8</span> [User] 출력 서열 앞쪽에 각 서열의 accession number를 붙여주고 마지막에는 총 길이와 다른 서열의 개수 등 통계를 출력해줘</h4>
</section>
<section id="chatgpt-3" class="level4" data-number="5.3.5.9">
<h4 data-number="5.3.5.9" class="anchored" data-anchor-id="chatgpt-3"><span class="header-section-number">5.3.5.9</span> [ChatGPT]</h4>
<div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez, SeqIO</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> pairwise2</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.pairwise2 <span class="im">import</span> format_alignment</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Always provide your email when using NCBI's Entrez</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>Entrez.email <span class="op">=</span> <span class="st">"your.email@example.com"</span>  <span class="co"># Replace with your email address</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_sequence(accession):</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Download a sequence by its accession number from NCBI."""</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    handle <span class="op">=</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, <span class="bu">id</span><span class="op">=</span>accession, rettype<span class="op">=</span><span class="st">"gb"</span>, retmode<span class="op">=</span><span class="st">"text"</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    seq_record <span class="op">=</span> SeqIO.read(handle, <span class="st">"genbank"</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    handle.close()</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq_record</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_sequences(seq1, seq2):</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform a sequence alignment between two sequences and format the output."""</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    alignments <span class="op">=</span> pairwise2.align.globalms(seq1.seq, seq2.seq, <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="fl">0.5</span>, one_alignment_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> alignments[<span class="dv">0</span>]  <span class="co"># Return the first alignment</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_alignment(alignment, seq1_acc, seq2_acc, chunk_size<span class="op">=</span><span class="dv">60</span>):</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Print formatted alignment in chunks, including accession numbers and statistics."""</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2, score, start, end <span class="op">=</span> alignment</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>    alignment_length <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    total_mismatches <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> b1, b2 <span class="kw">in</span> <span class="bu">zip</span>(aligned_seq1, aligned_seq2) <span class="cf">if</span> b1 <span class="op">!=</span> b2)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Alignment Score: </span><span class="sc">{</span>score<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Total Length: </span><span class="sc">{</span>alignment_length<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Mismatches: </span><span class="sc">{</span>total_mismatches<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, alignment_length, chunk_size):</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>        subseq1 <span class="op">=</span> aligned_seq1[start<span class="op">+</span>i:start<span class="op">+</span>i<span class="op">+</span>chunk_size]</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>        subseq2 <span class="op">=</span> aligned_seq2[start<span class="op">+</span>i:start<span class="op">+</span>i<span class="op">+</span>chunk_size]</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate a matching line</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>        match_line <span class="op">=</span> <span class="st">''</span>.join(<span class="st">'|'</span> <span class="cf">if</span> b1 <span class="op">==</span> b2 <span class="cf">else</span> <span class="st">' '</span> <span class="cf">for</span> b1, b2 <span class="kw">in</span> <span class="bu">zip</span>(subseq1, subseq2))</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the alignment in chunks</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>seq1_acc<span class="sc">}</span><span class="ss"> (position </span><span class="sc">{</span>start<span class="op">+</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span><span class="bu">min</span>(start<span class="op">+</span>i<span class="op">+</span>chunk_size, alignment_length)<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(subseq1)</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(match_line)</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seq2_acc<span class="sc">}</span><span class="ss"> (position </span><span class="sc">{</span>start<span class="op">+</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span><span class="bu">min</span>(start<span class="op">+</span>i<span class="op">+</span>chunk_size, alignment_length)<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(subseq2)</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Accession numbers for EGFP and sfGFP</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>egfp_accession <span class="op">=</span> <span class="st">"U55762"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>sfgfp_accession <span class="op">=</span> <span class="st">"EU304438"</span>  <span class="co"># Example accession, update as necessary</span></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Download sequences</span></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>egfp_seq <span class="op">=</span> download_sequence(egfp_accession)</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>sfgfp_seq <span class="op">=</span> download_sequence(sfgfp_accession)</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare sequences</span></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>alignment <span class="op">=</span> compare_sequences(egfp_seq, sfgfp_seq)</span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Print formatted alignment</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>print_alignment(alignment, egfp_accession, sfgfp_accession, chunk_size<span class="op">=</span><span class="dv">60</span>)  <span class="co"># You can adjust the chunk size as needed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-66" class="cell" data-executioninfo="{&quot;elapsed&quot;:9221,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718005716006,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="34e3ae67-4525-4eec-a0a7-9c9b0e99ec19" data-execution_count="24">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install matplotlib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (3.7.1)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.2.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (4.53.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.4.5)
Requirement already satisfied: numpy&gt;=1.20 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (1.25.2)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (24.0)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (9.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (3.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib) (2.8.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.16.0)</code></pre>
</div>
</div>
</section>
<section id="user-위-비교-결과를-한-줄로-표현되는-그래프로-그려주는-코드를-알려줘" class="level4" data-number="5.3.5.10">
<h4 data-number="5.3.5.10" class="anchored" data-anchor-id="user-위-비교-결과를-한-줄로-표현되는-그래프로-그려주는-코드를-알려줘"><span class="header-section-number">5.3.5.10</span> [User] 위 비교 결과를 한 줄로 표현되는 그래프로 그려주는 코드를 알려줘</h4>
</section>
<section id="chatgpt-4" class="level4" data-number="5.3.5.11">
<h4 data-number="5.3.5.11" class="anchored" data-anchor-id="chatgpt-4"><span class="header-section-number">5.3.5.11</span> [ChatGPT]</h4>
<div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez, SeqIO</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> pairwise2</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Always provide your email when using NCBI's Entrez</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>Entrez.email <span class="op">=</span> <span class="st">"your.email@example.com"</span>  <span class="co"># Replace with your email address</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_sequence(accession):</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Download a sequence by its accession number from NCBI."""</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    handle <span class="op">=</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, <span class="bu">id</span><span class="op">=</span>accession, rettype<span class="op">=</span><span class="st">"gb"</span>, retmode<span class="op">=</span><span class="st">"text"</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    seq_record <span class="op">=</span> SeqIO.read(handle, <span class="st">"genbank"</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    handle.close()</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq_record</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_sequences(seq1, seq2):</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Perform a sequence alignment between two sequences and format the output."""</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    alignments <span class="op">=</span> pairwise2.align.globalms(seq1.seq, seq2.seq, <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="fl">0.5</span>, one_alignment_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> alignments[<span class="dv">0</span>]  <span class="co"># Return the first alignment</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_alignment(alignment):</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Plot alignment as a line graph."""</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2, score, start, end <span class="op">=</span> alignment</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create match scores: 1 for match, 0 for mismatch</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>    match_scores <span class="op">=</span> [<span class="dv">1</span> <span class="cf">if</span> b1 <span class="op">==</span> b2 <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> b1, b2 <span class="kw">in</span> <span class="bu">zip</span>(aligned_seq1, aligned_seq2)]</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the results</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span>))</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>    plt.plot(match_scores, color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"Sequence Alignment"</span>)</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Position"</span>)</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Match (1) / Mismatch (0)"</span>)</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>    plt.ylim(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)  <span class="co"># Keep the y-axis tight to match/mismatch values</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Accession numbers for EGFP and sfGFP</span></span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a>egfp_accession <span class="op">=</span> <span class="st">"U55762"</span></span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>sfgfp_accession <span class="op">=</span> <span class="st">"EU304438"</span></span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Download sequences</span></span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>egfp_seq <span class="op">=</span> download_sequence(egfp_accession)</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a>sfgfp_seq <span class="op">=</span> download_sequence(sfgfp_accession)</span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare sequences</span></span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a>alignment <span class="op">=</span> compare_sequences(egfp_seq, sfgfp_seq)</span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the alignment graphically</span></span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a>plot_alignment(alignment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="multiple-sequence-alignment-objects" class="level3" data-number="5.3.6">
<h3 data-number="5.3.6" class="anchored" data-anchor-id="multiple-sequence-alignment-objects"><span class="header-section-number">5.3.6</span> Multiple sequence alignment objects</h3>
<ul>
<li>http://biopython.org/DIST/docs/tutorial/Tutorial.html#htoc70<br>
</li>
<li>Bio.AlignIO.read() returns a single MultipleSeqAlignment object<br>
</li>
<li>Bio.AlignIO.parse() returns MultipleSeqAlignment objects</li>
</ul>
<div id="cell-71" class="cell" data-executioninfo="{&quot;elapsed&quot;:1248,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718008052576,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="0d03204d-c4e0-47bb-fc1a-3569c660b4eb" data-execution_count="45">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Entrez</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>Entrez.email <span class="op">=</span> <span class="st">"kimhaseong@gmail.com"</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Searching NCBI Nucleotide database</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>handle <span class="op">=</span> Entrez.esearch(db<span class="op">=</span><span class="st">"nucleotide"</span>, term<span class="op">=</span><span class="st">"esterase[All Fields] AND </span><span class="ch">\"</span><span class="st">Escherichia coli</span><span class="ch">\"</span><span class="st">[Primary Organism] AND (</span><span class="ch">\"</span><span class="st">580</span><span class="ch">\"</span><span class="st">[SLEN] : </span><span class="ch">\"</span><span class="st">600</span><span class="ch">\"</span><span class="st">[SLEN])"</span>, idtype<span class="op">=</span><span class="st">"acc"</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>record <span class="op">=</span> Entrez.read(handle)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(record[<span class="st">"IdList"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['NZ_CANUGE010000080.1', 'NZ_CANUHA010000080.1', 'NZ_CANUFW010000086.1', 'NZ_JAINSC010000053.1', 'NZ_JAUOTQ010000344.1', 'NZ_RQOE01000407.1', 'RQOE01000407.1', 'QFSK01000273.1', 'PTNY01001592.1', 'NSEG01000063.1', 'KP965724.1', 'AZLZ01000386.1']</code></pre>
</div>
</div>
<div id="cell-72" class="cell" data-executioninfo="{&quot;elapsed&quot;:5089,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718008875029,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-execution_count="66">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>myidx <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>entids <span class="op">=</span> [record[<span class="st">"IdList"</span>][x] <span class="cf">for</span> x <span class="kw">in</span> myidx]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>entids</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>stream <span class="op">=</span> Entrez.efetch(db<span class="op">=</span><span class="st">"nucleotide"</span>, rettype<span class="op">=</span><span class="st">"fasta"</span>, retmode<span class="op">=</span><span class="st">"text"</span>, <span class="bu">id</span><span class="op">=</span>entids)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co">#write to an output file</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"data/esterase.fasta"</span>, <span class="st">"w"</span>) <span class="im">as</span> output:</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    output.write(stream.read())</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>stream.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Alignment tools</p></li>
<li><p>Clustalw를 이용한 서열 정렬 (cactus family Opuntia(선인장))</p></li>
</ul>
<div id="cell-75" class="cell" data-executioninfo="{&quot;elapsed&quot;:23124,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718007534331,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="c3009dc7-bd03-43c9-ce35-e61787e7e9fe" data-execution_count="32">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>sudo apt<span class="op">-</span>get update</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>sudo apt<span class="op">-</span>get install <span class="op">-</span>y clustalw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0% [Working]            Get:1 https://cloud.r-project.org/bin/linux/ubuntu jammy-cran40/ InRelease [3,626 B]
Get:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64  InRelease [1,581 B]
Get:3 https://cloud.r-project.org/bin/linux/ubuntu jammy-cran40/ Packages [53.5 kB]
Get:4 http://security.ubuntu.com/ubuntu jammy-security InRelease [129 kB]
Hit:5 http://archive.ubuntu.com/ubuntu jammy InRelease
Get:6 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64  Packages [917 kB]
Get:7 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [128 kB]
Hit:8 https://ppa.launchpadcontent.net/c2d4u.team/c2d4u4.0+/ubuntu jammy InRelease
Get:9 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu jammy InRelease [18.1 kB]
Get:10 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [127 kB]
Get:11 http://security.ubuntu.com/ubuntu jammy-security/main amd64 Packages [1,885 kB]
Get:12 https://ppa.launchpadcontent.net/graphics-drivers/ppa/ubuntu jammy InRelease [24.3 kB]
Get:13 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [2,160 kB]
Hit:14 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy InRelease
Get:15 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu jammy/main amd64 Packages [27.8 kB]
Get:16 https://ppa.launchpadcontent.net/graphics-drivers/ppa/ubuntu jammy/main amd64 Packages [47.9 kB]
Get:17 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [1,389 kB]
Get:18 http://archive.ubuntu.com/ubuntu jammy-updates/multiverse amd64 Packages [51.5 kB]
Get:19 http://archive.ubuntu.com/ubuntu jammy-backports/universe amd64 Packages [31.8 kB]
Get:20 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 Packages [2,439 kB]
Get:21 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 Packages [1,088 kB]
Fetched 10.5 MB in 14s (773 kB/s)
Reading package lists... Done
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Suggested packages:
  clustalx seaview
The following NEW packages will be installed:
  clustalw
0 upgraded, 1 newly installed, 0 to remove and 49 not upgraded.
Need to get 275 kB of archives.
After this operation, 818 kB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu jammy/universe amd64 clustalw amd64 2.1+lgpl-7 [275 kB]
Fetched 275 kB in 1s (257 kB/s)
debconf: unable to initialize frontend: Dialog
debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 78, &lt;&gt; line 1.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin: 
Selecting previously unselected package clustalw.
(Reading database ... 121913 files and directories currently installed.)
Preparing to unpack .../clustalw_2.1+lgpl-7_amd64.deb ...
Unpacking clustalw (2.1+lgpl-7) ...
Setting up clustalw (2.1+lgpl-7) ...
Processing triggers for man-db (2.10.2-1) ...</code></pre>
</div>
</div>
<div id="cell-76" class="cell" data-executioninfo="{&quot;elapsed&quot;:417,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718007627527,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="34d4a6db-5e27-4a22-b7ba-e676fc97e43f" data-execution_count="36">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>clustalw <span class="op">-</span><span class="bu">help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>


 CLUSTAL 2.1 Multiple Sequence Alignments


                DATA (sequences)

-INFILE=file.ext                             :input sequences.
-PROFILE1=file.ext  and  -PROFILE2=file.ext  :profiles (old alignment).


                VERBS (do things)

-OPTIONS            :list the command line parameters
-HELP  or -CHECK    :outline the command line params.
-FULLHELP           :output full help content.
-ALIGN              :do full multiple alignment.
-TREE               :calculate NJ tree.
-PIM                :output percent identity matrix (while calculating the tree)
-BOOTSTRAP(=n)      :bootstrap a NJ tree (n= number of bootstraps; def. = 1000).
-CONVERT            :output the input sequences in a different file format.


                PARAMETERS (set things)

***General settings:****
-INTERACTIVE :read command line, then enter normal interactive menus
-QUICKTREE   :use FAST algorithm for the alignment guide tree
-TYPE=       :PROTEIN or DNA sequences
-NEGATIVE    :protein alignment with negative values in matrix
-OUTFILE=    :sequence alignment file name
-OUTPUT=     :CLUSTAL(default), GCG, GDE, PHYLIP, PIR, NEXUS and FASTA
-OUTORDER=   :INPUT or ALIGNED
-CASE        :LOWER or UPPER (for GDE output only)
-SEQNOS=     :OFF or ON (for Clustal output only)
-SEQNO_RANGE=:OFF or ON (NEW: for all output formats)
-RANGE=m,n   :sequence range to write starting m to m+n
-MAXSEQLEN=n :maximum allowed input sequence length
-QUIET       :Reduce console output to minimum
-STATS=      :Log some alignents statistics to file

***Fast Pairwise Alignments:***
-KTUPLE=n    :word size
-TOPDIAGS=n  :number of best diags.
-WINDOW=n    :window around best diags.
-PAIRGAP=n   :gap penalty
-SCORE       :PERCENT or ABSOLUTE


***Slow Pairwise Alignments:***
-PWMATRIX=    :Protein weight matrix=BLOSUM, PAM, GONNET, ID or filename
-PWDNAMATRIX= :DNA weight matrix=IUB, CLUSTALW or filename
-PWGAPOPEN=f  :gap opening penalty        
-PWGAPEXT=f   :gap opening penalty


***Multiple Alignments:***
-NEWTREE=      :file for new guide tree
-USETREE=      :file for old guide tree
-MATRIX=       :Protein weight matrix=BLOSUM, PAM, GONNET, ID or filename
-DNAMATRIX=    :DNA weight matrix=IUB, CLUSTALW or filename
-GAPOPEN=f     :gap opening penalty        
-GAPEXT=f      :gap extension penalty
-ENDGAPS       :no end gap separation pen. 
-GAPDIST=n     :gap separation pen. range
-NOPGAP        :residue-specific gaps off  
-NOHGAP        :hydrophilic gaps off
-HGAPRESIDUES= :list hydrophilic res.    
-MAXDIV=n      :% ident. for delay
-TYPE=         :PROTEIN or DNA
-TRANSWEIGHT=f :transitions weighting
-ITERATION=    :NONE or TREE or ALIGNMENT
-NUMITER=n     :maximum number of iterations to perform
-NOWEIGHTS     :disable sequence weighting


***Profile Alignments:***
-PROFILE      :Merge two alignments by profile alignment
-NEWTREE1=    :file for new guide tree for profile1
-NEWTREE2=    :file for new guide tree for profile2
-USETREE1=    :file for old guide tree for profile1
-USETREE2=    :file for old guide tree for profile2


***Sequence to Profile Alignments:***
-SEQUENCES   :Sequentially add profile2 sequences to profile1 alignment
-NEWTREE=    :file for new guide tree
-USETREE=    :file for old guide tree


***Structure Alignments:***
-NOSECSTR1     :do not use secondary structure-gap penalty mask for profile 1 
-NOSECSTR2     :do not use secondary structure-gap penalty mask for profile 2
-SECSTROUT=STRUCTURE or MASK or BOTH or NONE   :output in alignment file
-HELIXGAP=n    :gap penalty for helix core residues 
-STRANDGAP=n   :gap penalty for strand core residues
-LOOPGAP=n     :gap penalty for loop regions
-TERMINALGAP=n :gap penalty for structure termini
-HELIXENDIN=n  :number of residues inside helix to be treated as terminal
-HELIXENDOUT=n :number of residues outside helix to be treated as terminal
-STRANDENDIN=n :number of residues inside strand to be treated as terminal
-STRANDENDOUT=n:number of residues outside strand to be treated as terminal 


***Trees:***
-OUTPUTTREE=nj OR phylip OR dist OR nexus
-SEED=n        :seed number for bootstraps.
-KIMURA        :use Kimura's correction.   
-TOSSGAPS      :ignore positions with gaps.
-BOOTLABELS=node OR branch :position of bootstrap values in tree display
-CLUSTERING=   :NJ or UPGMA</code></pre>
</div>
</div>
<div id="cell-77" class="cell" data-executioninfo="{&quot;elapsed&quot;:522,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718008881403,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="92caa129-12e7-488d-81f5-f2a3e0bb31f6" data-execution_count="67">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cat data<span class="op">/</span>esterase.fasta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&gt;NZ_CANUGE010000080.1 Escherichia coli strain ROAR-416 / O18:H7 / fimH15 / 95 (ST Warwick) isolate Faeces NODE_80_length_585_cov_58.954717, whole genome shotgun sequence
GGCGGCCTCTATACCCGCTTATGGCATGACAGCGTCAGCAGTACTGCGCTCCATCGCCAGCACAACATGA
AGGAGGAAACCCCGGGATAGTTACTGGACACGTAATGTATTAAAAACACAGTCAGAAGCGGCGGTACCGT
GAATAGCCGCTTTAATTATTTATACTGACATCCTTAATTTTTAAAGAGTATGAATGCTGAACATGCAACA
ACATCCCTCTGCTATCGCCAGCCTGCGCAACCAACTGGCAGCGGGCCACATTGCTAACCTTACTGACTTC
TGGCGCGAAGCTGAGTCGCTGAATGTTCCTCTTGTGACGCCAGTCGAAGGAGCGGAAGATGAGCGAGAAG
TGACCTTTCTGTGGCGCGCCCGACATCCTCTGCAGGGCGTTTATCTGCGTCTGAACCGGGTGACGGATAA
AGAGCACGTAGAAAAAGGAATGATGAGCGCCCTTCCCGAAACGGATATCTGGACACTGACACTGCGTTTA
CCCGCAAGTTACTGCGGCTCCTATTCGCTGCTGGAAATCCCCCCCGGCACTACGGCTGAGACGATTGCAC
TGTCCGGAGGCCGTTTTGCCACCCT

&gt;NZ_JAUOTQ010000344.1 Escherichia coli strain SCL2922 NODE_344_length_581_cov_2.811508, whole genome shotgun sequence
GAATGGAACGGCGGCTTCCACACCGGACAACTGCTTACCTCCATGCGCATTATCGCCGGGAAATCTCGCC
AGGTTCGGCTCTATATTCCGGACGTTGATATTTCTCAGCCCCTCGGGCTGGTCGTGCTGCCCGATGGTGA
AACCTGGTTTGATCACCTTGGCGTATGCGCGGCAATTGACGCCGCCATAAATAACAGGCGCATCGTGCCC
GTGGCTGTACTGGGCATTGACAACATTAATGAACATGAACGCACTGAGATACTCGGCGGGCGCAGCAAGC
TGATAAAGGATATCGCAGGACATCTGCTGCCGATGATCCGCGCTGAACAACCGCAGCGTCAGTGGGCAGA
CCGTTCGCGCACAGTGCTGGCCGGGCAGAGCCTCGGCGGGATCAGTGCACTAATGGGGGCTCGTTACGCA
CCGGAAACGTTCGGTCTGGTGCTCAGCCACTCTCCTTCAATGTGGTGGACGCCAGAAAGAACCAGTCTAC
CAGGCTTGTTCAGCGAAACCGATACCTCATGGGTGAGTGAGCATCTGCTTTCTGCCCCACCGCAGGGCGT
GCGTATCAGCCTGTGCGTGGG

&gt;NZ_RQOE01000407.1 Escherichia coli strain S366 NODE_408_length_581_cov_1.19604, whole genome shotgun sequence
ACTGAATATCGCTCGGCAACGCCGCGGCTTATGGGGGCACTCCTACGGCGGCCTCTTCGTGCTGGATTCC
TGGCTGTCCTCCTCTTACTTCCGGTCGTACTACAGCGCCAGCCCGTCGTTGGGCAGAGGTTATGATGCTT
TGCTAAGCCGCGTTACGGCGGTTGAGCCTCTGCAATTCTGCGCCAAACACCTGGCGATAATGGAAGGCTC
GGCGACACAGGGTGATAACCGGGAAACGCATGCTGTCGGGGTGCTGTCGAAAATTCATACCACCCTCACT
ATACTGAAAGATAAAGGCGTCAATGCCGTATTTTGGGATTTCCCCAACCTAGGACACGGGCCGATGTTCA
ATGCCTCCTTTCGCCAGGCACTGTTAGATATCAGTGGTGAAAACGCAAATTACACAGCAGGTTGTCATGA
GTTAAGCCACTAAACACTGCCCGCTTTTACGCGGGCAGTACGCCTGAAACACTACGATCAGAATGATGCG
GTAACTCCGGCATAGTAAGCCCGGCCTGGCTCGTTATAGGTATTCGCCCCTTCAGAAGATCGGAAGATCT
GTTTATTGAGGATATTACTGA
</code></pre>
</div>
</div>
<div id="cell-78" class="cell" data-executioninfo="{&quot;elapsed&quot;:552,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718008886524,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="199f0951-dae0-45a7-d238-f83cea0f4a9e" data-execution_count="68">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>clustalw <span class="op">-</span>infile<span class="op">=</span>data<span class="op">/</span>esterase.fasta <span class="op">-</span>outfile<span class="op">=</span>data<span class="op">/</span>esterase.aln</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>


 CLUSTAL 2.1 Multiple Sequence Alignments


Sequence format is Pearson
Sequence 1: NZ_CANUGE010000080.1   585 bp
Sequence 2: NZ_JAUOTQ010000344.1   581 bp
Sequence 3: NZ_RQOE01000407.1      581 bp
Start of Pairwise alignments
Aligning...

Sequences (1:2) Aligned. Score:  4
Sequences (1:3) Aligned. Score:  4
Sequences (2:3) Aligned. Score:  3
Guide tree file created:   [data/esterase.dnd]

There are 2 groups
Start of Multiple Alignment

Aligning...
Group 1:                     Delayed
Group 2:                     Delayed
Alignment Score 3099

CLUSTAL-Alignment file created  [data/esterase.aln]
</code></pre>
</div>
</div>
<div id="cell-79" class="cell" data-executioninfo="{&quot;elapsed&quot;:641,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718008893233,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="cbd3ad0a-42b1-4471-f613-30cf125c9178" data-execution_count="69">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> AlignIO</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>align <span class="op">=</span> AlignIO.read(<span class="st">"data/esterase.aln"</span>, <span class="st">"clustal"</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(align)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Alignment with 3 rows and 641 columns
--------------GGCGGCCTCTATACCCGCTTATGGCATGAC...CCT NZ_CANUGE010000080.1
-----GAATGGAACGGCGGCTTCCACACCGGACAACTGCTTACC...--- NZ_JAUOTQ010000344.1
ACTGAATATCGCTCGGCAACG-CCGCGGCTTATGGGGGCACTCC...--- NZ_RQOE01000407.1</code></pre>
</div>
</div>
<div id="cell-80" class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>align.substitutions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-81" class="cell" data-executioninfo="{&quot;elapsed&quot;:533,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718008897354,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="64a06d57-1a47-41a6-ec02-f0afbd3e1bb0" data-execution_count="70">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> Phylo</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> Phylo.read(<span class="st">"data/esterase.dnd"</span>, <span class="st">"newick"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>Phylo.draw_ascii(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ______________________________________________________ NZ_CANUGE010000080.1
 |
_|_______________________________________________________ NZ_JAUOTQ010000344.1
 |
 |________________________________________________________ NZ_RQOE01000407.1
</code></pre>
</div>
</div>
<section id="position-specific-scoring-matrix-pssm-matrix" class="level4" data-number="5.3.6.1">
<h4 data-number="5.3.6.1" class="anchored" data-anchor-id="position-specific-scoring-matrix-pssm-matrix"><span class="header-section-number">5.3.6.1</span> Position specific scoring matrix (PSSM) matrix</h4>
<div id="cell-83" class="cell" data-executioninfo="{&quot;elapsed&quot;:479,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718009312323,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-execution_count="77">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> AlignIO</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Align <span class="im">import</span> AlignInfo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Pfam은 단백질 페밀리 database, 각 서열 그룹을 align 한 파일이 제공됨</li>
<li>Family: Sigma54_activ_2 (PF14532) https://www.ebi.ac.uk/interpro/entry/pfam/PF14532/</li>
</ul>
<div id="cell-85" class="cell" data-executioninfo="{&quot;elapsed&quot;:410,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010192728,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="ede3b4c5-b19f-4fd9-cebb-02435ed199a2" data-execution_count="79">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>align <span class="op">=</span> AlignIO.read(<span class="st">"/content/drive/MyDrive/2024-cnu-lecture/data/PF14532_full.txt"</span>, <span class="st">"stockholm"</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(align)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(align))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Alignment with 1240 rows and 765 columns
--------------------------------------------...--- A0A1F7TK17_9BACT/134-279
--------------------------------------------...--- A0A1H8MG25_9RHOB/297-456
--------------------------------------------...--- A0A0P1IVG1_9RHOB/141-283
--------------------------------------------...--- V7EPJ0_9RHOB/141-283
--------------------------------------------...--- B1ZTM1_OPITP/145-296
--------------------------------------------...--- W3ANH6_9FIRM/219-355
--------------------------------------------...--- Q6LNI3_PHOPR/144-289
--------------------------------------------...--- A0A1G8U4Y5_9RHOB/145-284
--------------------------------------------...--- W1HPT9_KLEPN/143-283
--------------------------------------------...--- A0A0D6TAT1_9RHOB/146-292
--------------------------------------------...--- A0A1M4UVA9_9CLOT/309-454
--------------------------------------------...--- A0A252BQ85_9PROT/8-137
--------------------------------------------...--- A0A0P1G5P1_9RHOB/143-285
--------------------------------------------...--- A0A1M6RYM0_PSETH/338-463
--------------------------------------------...--- A0A0P7EE64_9GAMM/139-307
--------------------------------------------...--- A0A1I6GDU4_9RHOB/146-282
--------------------------------------------...--- A0A1G0NB92_9PROT/137-274
--------------------------------------------...--- A0A0C5W5C5_9GAMM/145-290
...
--------------------------------------------...--- A0A2A4B1F3_9SPHN/145-294
1240</code></pre>
</div>
</div>
<ul>
<li>slicing alignment</li>
</ul>
<div id="cell-87" class="cell" data-executioninfo="{&quot;elapsed&quot;:383,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010333247,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="38d4c949-9159-4395-a1ef-25bcef3d4108" data-execution_count="83">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(align[<span class="dv">3</span>:<span class="dv">8</span>,<span class="dv">100</span>:<span class="dv">200</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Alignment with 5 rows and 100 columns
--V---A---R---V---M--------N---T----D-------...K-- V7EPJ0_9RHOB/141-283
--V---K---K---L---A--------A---V----R-------...E-- B1ZTM1_OPITP/145-296
--A---E---K---L---S--------R---T----D-------...N-- W3ANH6_9FIRM/219-355
--I---A---N---I---A--------L---T----N-------...K-- Q6LNI3_PHOPR/144-289
--V---R---L---V---A--------R---A----G-------...E-- A0A1G8U4Y5_9RHOB/145-284</code></pre>
</div>
</div>
<ul>
<li>Turn the alignment object into an array of letters</li>
</ul>
<div id="cell-89" class="cell" data-executioninfo="{&quot;elapsed&quot;:582,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010491574,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="4b449e19-55c9-4b51-c024-031aefa1747f" data-execution_count="88">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> AlignIO</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>align <span class="op">=</span> AlignIO.read(<span class="st">"/content/drive/MyDrive/2024-cnu-lecture/data/esterase.aln"</span>, <span class="st">"clustal"</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to character array</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>align_array <span class="op">=</span> np.array([<span class="bu">list</span>(rec) <span class="cf">for</span> rec <span class="kw">in</span> align], <span class="st">'U'</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(align_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[['-' '-' '-' ... 'C' 'C' 'T']
 ['-' '-' '-' ... '-' '-' '-']
 ['A' 'C' 'T' ... '-' '-' '-']]
(3, 641)</code></pre>
</div>
</div>
<p>Note that this leaves the original Biopython alignment object and the NumPy array in memory as separate objects - editing one will not update the other!</p>
<div id="cell-91" class="cell" data-executioninfo="{&quot;elapsed&quot;:393,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010506445,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="9090c6f1-93f9-44eb-c0a6-8846e2da57f9" data-execution_count="89">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>align_array.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>(3, 641)</code></pre>
</div>
</div>
<ul>
<li>SummaryInfo 클래스</li>
<li>consensus sequence, position specific score matrix 계산</li>
<li>information content와 substitution 정보 계산 가능</li>
</ul>
<div id="cell-93" class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010631713,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="182f6e8a-8f1e-41a3-f3c4-c6ffa681741e" data-execution_count="97">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>summary_align <span class="op">=</span> AlignInfo.SummaryInfo(align)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>consensus <span class="op">=</span> summary_align.dumb_consensus()</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(consensus)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>my_pssm <span class="op">=</span> summary_align.pos_specific_score_matrix(consensus, chars_to_ignore <span class="op">=</span> [<span class="st">'N'</span>, <span class="st">'-'</span>])</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(my_pssm)</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># your_pssm[sequence_number][residue_count_name]</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>[s <span class="cf">for</span> s <span class="kw">in</span> my_pssm][:<span class="dv">20</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ACTGAXXATXGXXCGGCXXCXTCXXXXXCXXXXXXXXGCXXXXCXXCXXXXGCXXXXXXGXXXXGXXXXXXXGXCXGXXXXXXXXXXAXXXXXXGXXXXXXXAXAXXXCXXXXXXXXXCGGXXTGGXCXXXXXXXXXXXTXXTGXXXCXXXGXXXXXXXACXXXGGXXXXXXCXXXGCAATXGXXGCXXXXAXXAXXXXXXXXXXXATXGXXXXXXXXXXXXXAXXGXGXXXXXAXCGGXXXXXXXATGCXXXXXXXXXXCXXTCGXXXATXXXXXXCXXXCXCAXXXXXCTGXXAXXXXXXXXCXXXXXXXXXXTXXTXXXGGAXXXXXXXXXCXXAXXAXXCGXXXXGXXXXTXXXXXXCXCCXXTXGXXXXXXXXXXXXXXXXXXCXGXXXXXXXXXXXXAAXTXAXXXXXCXXXXXXXXXXXXGXXAXXCXXXXXAXXXXXXXXXXCTXXXXCXXXXXCXXGTXXCXXXXXAXXXXCACGXXXXXXXXXGAAXGATGAXCXXXXXXXCXGXXXXXXXXAXCXXGXXACXGXXXCXXXXTXXXXXXGXXXGXXXXXGCXXXTXXXXXXXXXXGXXXGXXXTXXXXXXXXXXXXTXXXXXTGXGACGATTGCACTGTCCGGAGGCCGTTTTGCCACCCT</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>[{'A': 1.0, 'C': 0, 'G': 0, 'T': 0},
 {'A': 0, 'C': 1.0, 'G': 0, 'T': 0},
 {'A': 0, 'C': 0, 'G': 0, 'T': 1.0},
 {'A': 0, 'C': 0, 'G': 1.0, 'T': 0},
 {'A': 1.0, 'C': 0, 'G': 0, 'T': 0},
 {'A': 1.0, 'C': 0, 'G': 1.0, 'T': 0},
 {'A': 1.0, 'C': 0, 'G': 0, 'T': 1.0},
 {'A': 2.0, 'C': 0, 'G': 0, 'T': 0},
 {'A': 0, 'C': 0, 'G': 0, 'T': 2.0},
 {'A': 0, 'C': 1.0, 'G': 1.0, 'T': 0},
 {'A': 0, 'C': 0, 'G': 2.0, 'T': 0},
 {'A': 1.0, 'C': 1.0, 'G': 0, 'T': 0},
 {'A': 1.0, 'C': 0, 'G': 0, 'T': 1.0},
 {'A': 0, 'C': 2.0, 'G': 0, 'T': 0},
 {'A': 0, 'C': 0, 'G': 3.0, 'T': 0},
 {'A': 0, 'C': 0, 'G': 3.0, 'T': 0},
 {'A': 0, 'C': 3.0, 'G': 0, 'T': 0},
 {'A': 1.0, 'C': 0, 'G': 2.0, 'T': 0},
 {'A': 1.0, 'C': 0, 'G': 2.0, 'T': 0},
 {'A': 0, 'C': 3.0, 'G': 0, 'T': 0}]</code></pre>
</div>
</div>
<div id="cell-94" class="cell" data-executioninfo="{&quot;elapsed&quot;:600,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010646782,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="8a173322-9ae0-4e3b-8dfb-e9e88c7a2de0" data-execution_count="98">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>instances <span class="op">=</span> [al.seq <span class="cf">for</span> al <span class="kw">in</span> align[:<span class="dv">10</span>]]</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(instances)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[Seq('--------------GGCGGCCTCTATACCCGCTTATGGCATGACAGCGTCAGCA...CCT'), Seq('-----GAATGGAACGGCGGCTTCCACACCGGACAACTGCTTACCTCCATGCGCA...---'), Seq('ACTGAATATCGCTCGGCAACG-CCGCGGCTTATGGGGGCACTCCTACGGCGGCC...---')]</code></pre>
</div>
</div>
</section>
<section id="motif" class="level4" data-number="5.3.6.2">
<h4 data-number="5.3.6.2" class="anchored" data-anchor-id="motif"><span class="header-section-number">5.3.6.2</span> Motif</h4>
<ul>
<li>Bio.motifs package included in Biopython 1.61</li>
</ul>
<div id="cell-97" class="cell" data-executioninfo="{&quot;elapsed&quot;:454,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010666324,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-execution_count="99">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> motifs</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-98" class="cell" data-executioninfo="{&quot;elapsed&quot;:394,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010667851,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-execution_count="100">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>instances <span class="op">=</span> [Seq(<span class="st">"TACAA"</span>),</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>            Seq(<span class="st">"TACGA"</span>),</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>            Seq(<span class="st">"TACAA"</span>),</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>            Seq(<span class="st">"TAGAA"</span>),</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>            Seq(<span class="st">"TACAA"</span>),</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>            Seq(<span class="st">"AACGA"</span>),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>           ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-99" class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010682563,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="2fd174c9-ffe7-4135-ef40-5e6c46f0e311" data-execution_count="101">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> motifs.create(instances)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TACAA
TACGA
TACAA
TAGAA
TACAA
AACGA</code></pre>
</div>
</div>
<div id="cell-100" class="cell" data-executioninfo="{&quot;elapsed&quot;:506,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010686254,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="88078b47-4c16-4fc4-9bd1-0aa698b3157b" data-execution_count="102">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>m.counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>{'A': [1.0, 6.0, 0.0, 4.0, 6.0],
 'C': [0.0, 0.0, 5.0, 0.0, 0.0],
 'G': [0.0, 0.0, 1.0, 2.0, 0.0],
 'T': [5.0, 0.0, 0.0, 0.0, 0.0]}</code></pre>
</div>
</div>
<div id="cell-101" class="cell" data-executioninfo="{&quot;elapsed&quot;:1131,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010715827,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="36931a48-da2e-40a8-f40b-8e87bb81696f" data-execution_count="105">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>m.counts[<span class="st">"A"</span>, <span class="dv">1</span>]</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> m.reverse_complement()</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r.consensus)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>r.weblogo(<span class="st">"data/mymotif.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TTGTA</code></pre>
</div>
</div>
<div id="cell-102" class="cell" data-executioninfo="{&quot;elapsed&quot;:659,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010734503,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="0856bd1d-4698-491a-f66a-7ad8807349c3" data-execution_count="106">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image, display</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>display(Image(filename<span class="op">=</span><span class="st">"/content/drive/MyDrive/2024-cnu-lecture/data/mymotif.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="cnu_bioinformatics_files/figure-html/cell-55-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Position-weight matrices 계산</li>
<li>.counts 특성 사용</li>
</ul>
<div id="cell-104" class="cell" data-executioninfo="{&quot;elapsed&quot;:1031,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010744158,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="751b5778-b941-4fab-a789-5388fbfb5fd1" data-execution_count="107">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>pwm <span class="op">=</span> m.counts.normalize(pseudocounts<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pwm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        0      1      2      3      4
A:   0.19   0.81   0.06   0.56   0.81
C:   0.06   0.06   0.69   0.06   0.06
G:   0.06   0.06   0.19   0.31   0.06
T:   0.69   0.06   0.06   0.06   0.06
</code></pre>
</div>
</div>
<div id="cell-105" class="cell" data-executioninfo="{&quot;elapsed&quot;:373,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010748791,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="ca5a2fc2-9a32-4afd-d265-abe658f85cce" data-execution_count="108">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>pssm <span class="op">=</span> pwm.log_odds()</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pssm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        0      1      2      3      4
A:  -0.42   1.70  -2.00   1.17   1.70
C:  -2.00  -2.00   1.46  -2.00  -2.00
G:  -2.00  -2.00  -0.42   0.32  -2.00
T:   1.46  -2.00  -2.00  -2.00  -2.00
</code></pre>
</div>
</div>
<div id="cell-106" class="cell" data-executioninfo="{&quot;elapsed&quot;:352,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718010751170,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="70b90032-f911-4137-d885-d48c3dabb5b6" data-execution_count="109">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>background <span class="op">=</span> {<span class="st">"A"</span>:<span class="fl">0.3</span>,<span class="st">"C"</span>:<span class="fl">0.2</span>,<span class="st">"G"</span>:<span class="fl">0.2</span>,<span class="st">"T"</span>:<span class="fl">0.3</span>}</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>pssm <span class="op">=</span> pwm.log_odds(background)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pssm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        0      1      2      3      4
A:  -0.68   1.44  -2.26   0.91   1.44
C:  -1.68  -1.68   1.78  -1.68  -1.68
G:  -1.68  -1.68  -0.09   0.64  -1.68
T:   1.20  -2.26  -2.26  -2.26  -2.26
</code></pre>
</div>
</div>
<ul>
<li>Using the PSSM score</li>
</ul>
<div id="cell-108" class="cell" data-executioninfo="{&quot;elapsed&quot;:342,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718011127453,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="afd5d319-803e-40aa-e377-58085593b153" data-execution_count="116">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pos, score <span class="kw">in</span> pssm.search(test_seq, threshold<span class="op">=</span><span class="fl">3.0</span>):</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%f</span><span class="st"> "</span> <span class="op">%</span> (pos, score))</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pssm.calculate(test_seq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0, 3.643981 
10, 6.759458 
[  3.643981    -8.560285    -2.4004133   -5.6533937   -4.2748823
  -0.05645879 -10.145247    -3.3293302   -5.9753222   -3.5703382
   6.759458    -5.3903594   -5.8598447   -0.81545067  -0.81545067
   0.7695118   -6.3903594   -3.5379167    0.4255574   -1.9309279
 -10.145247    -3.3293302 ]</code></pre>
</div>
</div>
<p><img src="PWMScanning.png" class="img-fluid"></p>
<div id="cell-110" class="cell" data-executioninfo="{&quot;elapsed&quot;:509,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1718011130324,&quot;user&quot;:{&quot;displayName&quot;:&quot;haseong kim&quot;,&quot;userId&quot;:&quot;15555769759698200025&quot;},&quot;user_tz&quot;:-540}" data-outputid="d9ac9a48-faba-4cf9-c92d-463db376e7da" data-execution_count="117">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>m.pseudocounts <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m.counts)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m.pwm)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(m.pssm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        0      1      2      3      4
A:   1.00   6.00   0.00   4.00   6.00
C:   0.00   0.00   5.00   0.00   0.00
G:   0.00   0.00   1.00   2.00   0.00
T:   5.00   0.00   0.00   0.00   0.00

        0      1      2      3      4
A:   0.17   0.95   0.02   0.64   0.95
C:   0.02   0.02   0.80   0.02   0.02
G:   0.02   0.02   0.17   0.33   0.02
T:   0.80   0.02   0.02   0.02   0.02

        0      1      2      3      4
A:  -0.54   1.93  -4.00   1.36   1.93
C:  -4.00  -4.00   1.67  -4.00  -4.00
G:  -4.00  -4.00  -0.54   0.39  -4.00
T:   1.67  -4.00  -4.00  -4.00  -4.00
</code></pre>
</div>
</div>
</section>
</section>
<section id="scikit-bio" class="level3" data-number="5.3.7">
<h3 data-number="5.3.7" class="anchored" data-anchor-id="scikit-bio"><span class="header-section-number">5.3.7</span> scikit-bio</h3>
<p>scikit-bio is another library focused on bioinformatics, providing functionalities for sequence analysis, alignment, phylogenetics, and more.</p>
<section id="installation-1" class="level4" data-number="5.3.7.1">
<h4 data-number="5.3.7.1" class="anchored" data-anchor-id="installation-1"><span class="header-section-number">5.3.7.1</span> Installation</h4>
<div class="sourceCode" id="cb121"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install scikit-bio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="basic-usage-examples" class="level4" data-number="5.3.7.2">
<h4 data-number="5.3.7.2" class="anchored" data-anchor-id="basic-usage-examples"><span class="header-section-number">5.3.7.2</span> Basic Usage Examples</h4>
<p><strong>Reading and Writing Sequence Files:</strong></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> skbio</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading a FASTA file</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> seq <span class="kw">in</span> skbio.io.read(<span class="st">"example.fasta"</span>, <span class="bu">format</span><span class="op">=</span><span class="st">"fasta"</span>):</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(seq.metadata[<span class="st">'id'</span>])</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(seq)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Writing to a FASTA file</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>sequences <span class="op">=</span> [seq <span class="cf">for</span> seq <span class="kw">in</span> skbio.io.read(<span class="st">"example.fasta"</span>, <span class="bu">format</span><span class="op">=</span><span class="st">"fasta"</span>)]</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>skbio.io.write(sequences, <span class="st">"output.fasta"</span>, <span class="bu">format</span><span class="op">=</span><span class="st">"fasta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Sequence Analysis:</strong></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skbio <span class="im">import</span> DNA, RNA, Protein</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating sequences</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>dna_seq <span class="op">=</span> DNA(<span class="st">"AGTACACTGGT"</span>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>rna_seq <span class="op">=</span> dna_seq.transcribe()</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>protein_seq <span class="op">=</span> dna_seq.translate()</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"DNA: "</span>, dna_seq)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RNA: "</span>, rna_seq)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Protein: "</span>, protein_seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Alignment:</strong></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skbio <span class="im">import</span> DNA</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skbio.alignment <span class="im">import</span> local_pairwise_align_ssw</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>seq1 <span class="op">=</span> DNA(<span class="st">"ACTGCTAGCTAG"</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>seq2 <span class="op">=</span> DNA(<span class="st">"GCTAGCTAGGTA"</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>alignment, score, start_end_positions <span class="op">=</span> local_pairwise_align_ssw(seq1, seq2)</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Alignment:</span><span class="ch">\n</span><span class="st">"</span>, alignment)</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Score:"</span>, score)</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Start-End Positions:"</span>, start_end_positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Phylogenetic Tree Construction:</strong></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skbio <span class="im">import</span> DistanceMatrix</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skbio.tree <span class="im">import</span> nj</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example distance matrix</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>dm <span class="op">=</span> DistanceMatrix([[<span class="fl">0.0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>],</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>                     [<span class="fl">0.2</span>, <span class="fl">0.0</span>, <span class="fl">0.6</span>],</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>                     [<span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.0</span>]],</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>                    [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>])</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Constructing a phylogenetic tree using Neighbor-Joining</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> nj(dm)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tree.ascii_art())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="example-analyzing-a-protein-sequence" class="level3" data-number="5.3.8">
<h3 data-number="5.3.8" class="anchored" data-anchor-id="example-analyzing-a-protein-sequence"><span class="header-section-number">5.3.8</span> Example: Analyzing a Protein Sequence</h3>
<p>Let’s put together an example that reads a protein sequence from a GenBank file, performs some basic analysis using Biopython, and aligns it using scikit-bio.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Seq <span class="im">import</span> Seq</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skbio <span class="im">import</span> Protein</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skbio.alignment <span class="im">import</span> global_pairwise_align_protein</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read a protein sequence from a GenBank file</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>record <span class="op">=</span> SeqIO.read(<span class="st">"example.gb"</span>, <span class="st">"genbank"</span>)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>protein_seq <span class="op">=</span> record.seq.translate()</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Protein Sequence:"</span>, protein_seq)</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform reverse translation to get the DNA sequence</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>dna_seq <span class="op">=</span> protein_seq.reverse_translate(table<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Reverse Translated DNA Sequence:"</span>, dna_seq)</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform alignment with another protein sequence</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>seq1 <span class="op">=</span> Protein(<span class="bu">str</span>(protein_seq))</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>seq2 <span class="op">=</span> Protein(<span class="st">"MKVLYNLKDG"</span>)</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>alignment, score, start_end_positions <span class="op">=</span> global_pairwise_align_protein(seq1, seq2)</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Alignment:</span><span class="ch">\n</span><span class="st">"</span>, alignment)</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Score:"</span>, score)</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Start-End Positions:"</span>, start_end_positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="explanation" class="level3" data-number="5.3.9">
<h3 data-number="5.3.9" class="anchored" data-anchor-id="explanation"><span class="header-section-number">5.3.9</span> Explanation:</h3>
<ul>
<li><strong>Reading Sequence</strong>: We use Biopython to read a protein sequence from a GenBank file.</li>
<li><strong>Sequence Analysis</strong>: We perform basic sequence operations like translation and reverse translation.</li>
<li><strong>Alignment</strong>: We use scikit-bio to perform a global pairwise alignment between two protein sequences.</li>
</ul>
<p>By mastering these bioinformatics libraries, you will be well-equipped to handle a wide range of bioinformatics tasks and analyses in your research. If you have specific questions or need further examples, feel free to ask!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./cnu_data_handling.html" class="pagination-link" aria-label="Data handling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data handling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./cnu_machine_learning.html" class="pagination-link" aria-label="Machine Learning">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Machine Learning</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>2024 lecture note written by Haseong Kim</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with Quarto</p>
</div>
  </div>
</footer>




</body></html>